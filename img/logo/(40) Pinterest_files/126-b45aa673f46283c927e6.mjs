(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[126],{"0BOE":function(e,t,i){i.d(t,"a",(function(){return s}));const n={á:"a",à:"a",â:"a",ä:"a",ã:"a",å:"a",æ:"a",ç:"c",é:"e",è:"e",ê:"e",ë:"e",í:"i",ì:"i",î:"i",ï:"i",ñ:"n",ó:"o",ò:"o",ô:"o",ö:"o",õ:"o",ø:"o",œ:"o",ß:"s",ú:"u",ù:"u",û:"u",ü:"u"},o=e=>{if(!e)return"";let t="";for(let i=0;i<e.length;i+=1)t+=n[e.charAt(i)]||e.charAt(i);return t},s=(e,t,i="name")=>{const n=t.toLowerCase();return e.filter(e=>((e,t)=>{const i=t.split(" "),n=e.split(" ");let s=0;for(let r=0;r<n.length;r+=1)(o(n[r]).includes(i[s])||n[r].includes(i[s]))&&(s+=1);return s===i.length})(e[i].toLowerCase(),n))}},"1RGD":function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("q1tI"),o=i("yweb"),s=i("vvax"),r=i("n6mq"),a=i("nKUr");function d({header:e,onUpdate:t,value:i}){const d=Object(o.c)(),[l,c]=Object(n.useState)(i?String(Math.floor(Number.parseInt(i,10)/60)):"0"),[u,h]=Object(n.useState)(i?String(Number.parseInt(i,10)%60):"0"),b=(e,i)=>{t(String(Number.parseInt(i,10)+60*Number.parseInt(e,10)))},p=[];for(let n=0;n<=9;n+=1)p.push({value:String(n),label:Object(s.b)(d.ngettext("{{ hours }} hour","{{ hours }} hours",n,"storyboard.detailsList.recipe","Option for number of hours a story pin recipe will take"),{hours:n}).join("")});const f=[];for(let n=0;n<60;n+=1)f.push({value:String(n),label:Object(s.b)(d.ngettext("{{ minutes }} minute","{{ minutes }} minutes",n,"storyboard.detailsList.recipe","Option for number of minutes a story pin recipe will take"),{minutes:n}).join("")});return Object(a.jsxs)(r.f,{width:"100%",display:"flex",alignItems:"end",children:[Object(a.jsx)(r.f,{width:"50%",marginEnd:2,children:Object(a.jsx)(r.S,{size:"lg",id:"hours",name:"hours",label:e,placeholder:d._("Hours","storyboard.detailsList.recipe","Placeholder caption for hours input in story pin recipe cooktime"),value:l,options:p,onChange:({value:e})=>{Number.isNaN(e)||(c(e),b(e,u))}})}),Object(a.jsx)(r.f,{width:"50%",marginStart:2,children:Object(a.jsx)(r.S,{size:"lg",id:"minutes",name:"minutes",placeholder:d._("Minutes","storyboard.detailsList.recipe","Placeholder caption for minutes input in story pin recipe cooktime"),value:u,options:f,onChange:({value:e})=>{Number.isNaN(e)||(h(e),b(l,e))}})})]})}},"2K7C":function(e,t,i){i.d(t,"a",(function(){return r}));var n=i("yweb"),o=i("n6mq"),s=i("nKUr");function r(){const e=Object(n.c)();return Object(s.jsx)(o.f,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(s.jsx)(o.U,{accessibilityLabel:e._("Loading editor","EditorWithMentionsFallback.loading","Message shown while waiting for the editor to load"),show:!0})})}},"2WXK":function(e,t,i){var n=i("q1tI");let o=null,s=!1,r=0;const a=()=>{o&&clearTimeout(o),s=!0,o=setTimeout(()=>{s=!1},100)};t.a=()=>{const[e,t]=Object(n.useState)(!1),i=Object(n.useRef)(null);Object(n.useEffect)(()=>(0===r&&window.addEventListener("scroll",a),r+=1,()=>{i.current&&clearTimeout(i.current),r-=1,r||window.removeEventListener("scroll",a)}),[]);const o=e=>{i.current&&clearTimeout(i.current),i.current=e&&s?setTimeout(()=>o(!0),100):setTimeout(()=>{t(e)},32)};return{isHovering:e,hoverHandlers:Object(n.useRef)({onMouseOver:()=>o(!0),onMouseLeave:()=>o(!1)}).current}}},"3z7j":function(e,t,i){i.d(t,"a",(function(){return o}));var n=i("Wer7");function o(e,t){return i=>i(Object(n.a)("BoardSectionResource",{field_set_key:t||"board_page",section_id:e}))}},"5FNA":function(e,t,i){i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return l}));var n=i("qtKf"),o=i("Pqnw"),s=i("Wer7");const r=["alphabetical","last_pinned_to","oldest","newest","group_boards_at_top","custom"],a={name:"BoardsResource",key:"boardsResource",options:({boardOrder:e,filterStories:t,mixPublicSecret:i,username:n})=>({privacy_filter:"all",sort:e||"last_pinned_to",field_set_key:"profile_grid_item",filter_stories:t,username:n,page_size:25,group_by:i?"mix_public_private":"visibility",include_archived:!0,redux_normalize_feed:!0})},d=(e,t,i)=>({privacy_filter:t?"secret":"public",sort:i||"last_pinned_to",field_set_key:"profile_grid_item",username:e}),l=e=>r.reduce((t,i)=>{const r=[Object(o.a)("profileBoards",Object(n.c)(e,i))];return[!0,!1].forEach(t=>{[!0,!1].forEach(n=>{r.push(Object(s.f)(a.name,a.options({username:e,boardOrder:i,mixPublicSecret:t,filterStories:n})))})}),t.concat(r)},[])},"5S2N":function(e,t,i){i.d(t,"c",(function(){return we})),i.d(t,"b",(function(){return Ee}));var n=i("q1tI"),o=i("/MKj"),s=i("9WJf"),r=i("BkRI"),a=i.n(r),d=i("yweb"),l=i("n6mq"),c=i("nKUr");function u({commentsDisabled:e,onCommentChange:t,onPhotoChange:i,photosDisabled:n,isManagedView:o,isNoTitle:s}){const r=Object(d.c)(),a=o?6:s?0:3;return Object(c.jsxs)(l.f,{children:[!s&&Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:o?0:4,paddingY:a,children:[!o&&!s&&Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",children:r._("Comment and Photo Permissions")})}),Object(c.jsxs)(l.f,{column:12,mdColumn:o?12:8,children:[Object(c.jsxs)(l.f,{paddingY:1,display:"flex",alignItems:"center",children:[Object(c.jsx)(l.W,{onChange:t,id:"CommentSwitch",switched:!e}),Object(c.jsx)(l.f,{paddingX:2,children:Object(c.jsx)(l.z,{htmlFor:"CommentSwitch",children:Object(c.jsx)(l.bb,{size:"md",children:r._("Allow people to comment","Label for toggling comments on a pin in pin edit form","Label for toggling comments on a pin in pin edit form")})})})]}),i&&Object(c.jsxs)(l.f,{paddingY:1,alignItems:"center",display:"flex",children:[Object(c.jsx)(l.W,{onChange:i,id:"PhotoSwitch",switched:!n}),Object(c.jsx)(l.f,{paddingX:2,children:Object(c.jsx)(l.z,{htmlFor:"PhotoSwitch",children:Object(c.jsx)(l.bb,{size:"md",children:r._("Allow people to upload photos","Label for toggling photos on a pin in pin edit form","Label for toggling photos on a pin in pin edit form")})})})]})]})]})]})}var h=i("JW66"),b=i("eOdZ"),p=i("5FNA"),f=i("Wer7");var j=i("Sihc"),g=i("Y+p1"),m=i.n(g),y=i("TgLd"),x=i("GBVV"),_=i("4cpq"),O=i("M1Uz"),v=i("nGHF");function S(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class C extends n.PureComponent{constructor(...e){super(...e),S(this,"state",{deleting:!1}),S(this,"unmounted",!1),S(this,"handleConfirm",()=>{if(this.state.deleting)return;const{onDeletePin:e}=this.props;this.setState({deleting:!0}),e().then(()=>this.handleDeleteDidComplete()).catch(e=>this.handleDeleteDidComplete(e))}),S(this,"handleDeleteDidComplete",e=>{const{toastManagerContext:t}=this.props;this.unmounted||this.setState({deleting:!1}),e||t.showToast(({onHide:e})=>Object(c.jsx)(O.a,{onHide:e,text:this.props.i18n._("Pin deleted!","User deleted their pin","User deleted their pin")}))})}componentWillUnmount(){this.unmounted=!0}render(){const{onDismiss:e}=this.props,{deleting:t}=this.state;return Object(c.jsx)(y.b,{heading:this.props.i18n._("Are you sure?","Confirm the user wants to delete the pin","Confirm the user wants to delete the pin"),accessibilityModalLabel:this.props.i18n._("Are you sure you want to delete this pin?","Accessible label to confirm the user wants to delete the pin","Accessible label to confirm the user wants to delete the pin"),size:"sm",onDismiss:e,footer:Object(c.jsxs)(l.f,{display:"flex",justifyContent:"end",marginStart:-1,marginEnd:-1,children:[Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(l.g,{fullWidth:!0,onClick:e,text:this.props.i18n._("Cancel")})}),Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(_.a,{id:"confirm-delete-pin",children:Object(c.jsx)(x.b,{color:"red",onClick:this.handleConfirm,text:this.props.i18n._("Delete Pin"),submitting:t})})})]}),children:Object(c.jsx)(l.f,{padding:4,children:Object(c.jsx)(l.bb,{children:this.props.i18n._("Once you delete a Pin, you can't undo it!")})})})}}const w=Object(v.c)((function(e){const t=Object(d.c)();return Object(c.jsx)(C,{...e,i18n:t})}));w.displayName="DeletePinConfirmation";var I=w;function E({canEdit:e,onAltTextChange:t,altText:i}){const o=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"AltTextField",children:Object(c.jsx)(l.bb,{size:"md",children:o._("Alt text","EditPinModal.EditAltText","Label for editing alt text of pin")})})}),Object(c.jsx)(l.f,{column:12,mdColumn:8,children:e?Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.f,{children:Object(c.jsx)(l.db,{id:"AltTextField",onChange:({value:e})=>t({value:e.slice(0,500)}),size:"lg",value:i||""})}),Object(c.jsx)(l.f,{children:Object(c.jsx)(l.z,{htmlFor:"AltTextField",children:Object(c.jsx)(l.f,{marginTop:1,children:Object(c.jsx)(l.bb,{size:"md",color:"gray",children:o._("This helps people using screen readers understand what your Pin is about.","EditPinModal.EditAltText","Label for editing alt text of pin")})})})})]}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i})})})]})]})}var k=i("V711"),P=i("sUAf");function B({board:e={},canEdit:t,isOriginallyQuickCreatesBoard:i,onBoardChange:n,onBoardCreate:o,viewerId:s}){const r=Object(d.c)(),{showEnabledSaveBehavior:a}=Object(P.a)(s),u="quick_saves"===e.layout&&a,h="quick_creates"===e.layout;return Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"BoardPicker",children:Object(c.jsx)(l.bb,{size:"md",children:i?r._("Organize to a board (optional)","editPinModal.editBoard.optionalBoardLabel","Label for board dropdown to select optional board"):r._("Board")})})}),t?Object(c.jsx)(l.f,{column:12,mdColumn:8,children:Object(c.jsx)(k.a,{board:e,isBoardlessPinsBoard:u,isQuickCreatesBoard:h,onBoardChosen:n,onBoardCreate:o})}):e.name&&Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:e.name})})]})}var D=i("TSYQ"),M=i.n(D),T=i("JKZO"),R=i("Q7uW"),L=i("U4JR");function A(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class N extends n.Component{constructor(...e){super(...e),A(this,"state",{focused:!1}),A(this,"suggestionAnchorRef",Object(n.createRef)()),A(this,"setRef",e=>this.textAreaRef=e),A(this,"handleBlur",e=>{this.setState({focused:!1});const{onBlur:t}=this.props;t&&t(e)}),A(this,"handleFocus",e=>{this.setState({focused:!0});const{onFocus:t}=this.props;t&&t(e)}),A(this,"handleChange",({text:e,mentions:t})=>{this.props.onDescriptionChange({value:e,userMentionTags:t})})}render(){const{canAddUserMentionTags:e,canEdit:t,description:i,errorMessage:o,initialMentions:s,label:r,placeholder:a,onDescriptionChange:d}=this.props,{focused:u}=this.state;return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"DescriptionField",children:Object(c.jsx)(l.bb,{size:"md",children:r})})}),t?Object(c.jsxs)(l.f,{column:12,mdColumn:8,children:[Object(c.jsx)(l.f,{children:e?Object(c.jsx)("div",{className:M()("DescriptionField",{DescriptionField__error:!!o,DescriptionField__focus:u}),id:"DescriptionField",ref:this.suggestionAnchorRef,role:"textbox",children:Object(c.jsx)(T.a,{initialMentions:s,initialText:i,onAddMention:()=>{Object(L.b)(8905,{element:116,tag_type:1})},onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onSearchMentionCancel:()=>{Object(L.b)(8908,{element:116,tag_type:1})},onSuggestionsPopoverOpen:()=>{Object(L.b)(8907,{element:116,tag_type:1})},maxSuggestions:4,placeholder:a})}):Object(c.jsx)(l.cb,{id:"DescriptionField",placeholder:a,value:i,onChange:({value:e})=>{d({value:e,userMentionTags:[]})},hasError:(o||"").length>0})}),!!o&&Object(c.jsx)(l.f,{children:Object(c.jsx)(R.a,{errorMessage:o,htmlFor:"pin-edit-description"})})]}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i})})]})]})}}var U=N,F=i("VJm5"),z=i("rSLd"),H=i("xOLo");function V({isCarousel:e,onMouseEnter:t,onMouseLeave:i,shouldShowCarouselSliders:n,onCarouselSlide:o,currentIndex:s,carouselData:r,pinId:a,description:d,image:u={}}){return Object(c.jsxs)(l.f,{paddingX:4,paddingY:3,children:[e&&(()=>{const e=r&&r.carousel_slots&&r.carousel_slots.length||1;return e>=2&&Object(c.jsx)(l.f,{padding:2,children:Object(c.jsx)(l.z,{htmlFor:"CardsIndex",children:Object(c.jsxs)(l.bb,{size:"md",children:[s+1,"/",e]})})})})(),Object(c.jsx)(l.D,{width:236,children:Object(c.jsxs)(l.f,{onMouseEnter:t,onMouseLeave:i,children:[Object(c.jsxs)(l.D,{rounding:2,wash:!0,children:[e&&n&&Object(c.jsx)(l.f,{width:"100%",height:"100%",display:"inlineBlock",position:"absolute",dangerouslySetInlineStyle:{__style:{zIndex:10,background:"rgba(0, 0, 0, 0.3)"}},children:Object(c.jsx)(H.default,{handleCarouselSwipe:o,carouselIndex:s,carouselData:r,pinId:a,isEditMode:!0})}),e?Object(c.jsx)(F.a,{carouselIndex:s,isCloseup:!1,carouselData:r,pinId:a,isEditMode:!0}):Object(c.jsx)(l.y,{alt:d,color:"#efefef",naturalHeight:u.height,src:u.url,naturalWidth:u.width})]}),e&&Object(c.jsx)(z.default,{carouselIndex:s,carouselData:r,pinId:a,handleCarouselSwipe:o,isEditMode:!0,variant:"legacy"})]})})]})}function W({apiErrorMessage:e,shouldShowGenericUpdateError:t,onClickDeleteButton:i,disableDelete:n,onHide:o,shouldDisableSave:s,triggerBoardAndSectionCreate:r}){const a=Object(d.c)();return Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",marginStart:-1,marginEnd:-1,children:[Object(c.jsx)(_.a,{id:"delete-pin-button",children:Object(c.jsx)(l.g,{fullWidth:!0,text:a._("Delete","EditPinModal.EditPinFooter.Delete","delete pin"),onClick:i,disabled:n})}),t&&Object(c.jsx)(l.f,{display:"flex",marginStart:2,marginTop:2,justifyContent:"center",children:Object(c.jsx)(R.a,{errorMessage:e||a._("Sorry! There was an error editing your Pin.","EditPinModal.EditPinFooter.ErrorMessageToast","Toast for pin edit error"),htmlFor:"pin-edit-generic-error"})}),Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",marginStart:-2,marginEnd:-2,children:[Object(c.jsx)(l.f,{paddingX:2,children:Object(c.jsx)(l.g,{fullWidth:!0,text:a._("Cancel","EditPinModal.EditPinFooter.Cancel","cancel changes"),onClick:o})}),Object(c.jsx)(l.f,{paddingX:2,"data-test-id":"edit-pin-save",children:Object(c.jsx)(l.g,{fullWidth:!0,text:a._("Save","EditPinModal.EditPinFooter.Save","save changes"),color:"red",onClick:r,disabled:s})})]})]})}function q({pinNoteText:e,isCollaborative:t,onPinNoteChange:i}){const o=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"PinNoteField",children:Object(c.jsx)(l.bb,{size:"md",children:t?o._("Note to group","editPinModal.editPinNote.groupTitle","Label for editing private note on group Pin"):o._("Note to self","editPinModal.editPinNote.title","Label for editing private note on Pin")})})}),Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.cb,{errorMessage:e.length>=500?o._("Character limit reached","editPinModal.editPinNote.warningText","Text to inform user they have reached the length limit on Pin note"):void 0,id:"PinNoteField",onChange:i,placeholder:o._("Add a private note to remember your ideas about this Pin","editPinModal.editPinNote.placeholderText","Placeholder for editing private note"),value:e})})]})]})}var K=i("NXrh");function Y({board:e,canEdit:t,currentSection:i,onSectionChange:n,onSectionCreate:o,sectionId:s,sectionName:r}){const a=Object(d.c)(),u=null!=e&&e.id?K.b:K.a;return"quick_creates"===(null==e?void 0:e.layout)?null:Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:3,children:Object(c.jsx)(l.z,{htmlFor:"SectionPicker",children:Object(c.jsx)(l.bb,{size:"md",children:a._("Section","label for editing a Pin's board section","label for editing a Pin's board section")})})}),t&&e?Object(c.jsx)(l.f,{column:12,mdColumn:8,children:Object(c.jsx)(u,{board:e,onSectionChange:n,selectedSectionId:s,selectedSectionName:r,onSectionCreate:o})}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i&&!(e||{}).is_collaborative?i.title:a._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")})})]})}var Q=i("VBRM"),G=i("8Enz"),X=i("kT2/"),J=i("6HHy"),Z=i("1RGD");function $({keyValueBlocks:e,listBlocks:t,onUpdateKeyValueBlock:i,onUpdateListBlocks:o,templateType:s}){const r=Object(d.c)();return Object(c.jsxs)(l.f,{children:[1===s&&Object(c.jsxs)(n.Fragment,{children:[Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:r._("Cook time","editModal.editStoryPinModal.details.cookTime","Label for cook time detail")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(Z.a,{onUpdate:e=>i(0,e),value:e[0]||null})})]},"cooktime"),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:r._("Servings","editModal.editStoryPinModal.details.servings","Label for serving size detail")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(J.a,{showLabel:!1,onUpdate:e=>i(1,e),value:e[1]||null})})]},"servingSize")]}),2===s&&Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:r._("Difficulty","editModal.editStoryPinModal.details.difficulty","Label for difficulty level detail")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(G.a,{showLabel:!1,onUpdate:e=>i(2,e),value:e[2]||null})})]},"difficulty"),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:(()=>{switch(s){case 1:return r._("Ingredients","editModal.editStoryPinModal.listHeading","Heading for an ingredients list");case 2:return r._("Supplies","editModal.editStoryPinModal.listHeading","Heading for a supplies list");default:return r._("What they'll need","editModal.editStoryPinModal.listHeading","Heading for a generic list")}})()}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(X.a,{listBlocks:t,onUpdate:o})})]})]})}var ee=i("ESls"),te=i("Joxa");var ie=i("vvax"),ne=i("QAzJ"),oe=i("MNxV");var se=Object(o.connect)(()=>({}),e=>({completeResourceFetch:t=>e(Object(f.b)("PinResource",{field_set_key:"detailed",id:t.id},t)),invalidatePin:t=>e(Object(f.f)("PinResource",{field_set_key:"detailed",id:t}))}))((function({apiErrorMessage:e,board:t,completeResourceFetch:i,commentsDisabled:o,description:s,disableDelete:r,invalidatePin:a,isLoadingPin:h,isProcessing:p,onChangeBoard:f,onChangeComment:j,onChangeSection:g,onClickBoardCreate:m,onClickDeleteButton:x,onClickEditPages:_,onClickSectionCreate:O,onHide:v,pinResource:S,sectionId:C,sectionName:w,title:I,triggerBoardAndSectionCreate:E}){var P,B;const D=Object(d.c)(),M=null!==(P=S.data)&&void 0!==P?P:{},T=M.story_pin_data,L=null!==(B=M.images&&M.images["474x"])&&void 0!==B?B:{},[A,N]=Object(n.useState)(!1),[U,F]=Object(n.useState)(null),[z,H]=Object(n.useState)(!1),[V,W]=Object(n.useState)({}),[q,Y]=Object(n.useState)([]);Object(n.useEffect)(()=>{var e;const t=(null==T||null===(e=T.metadata)||void 0===e?void 0:e.basics)||null;if(t){const e=Object(te.b)(t);W(e.keyValueBlocks||{}),Y(e.listBlocks||[])}},[T]),Object(n.useEffect)(()=>{e&&F(e)},[e]);const G=(e,t)=>{W({...V,[e]:t}),N(!0)},X=e=>{Y(e),N(!0)},{anyEnabled:J}=Object(ne.b)("web_story_pin_edit_deprecation"),{anyEnabled:Z}=Object(ne.b)("web_sp2s"),se=M.created_at?new Date(M.created_at):null,re=se&&Object(Q.a)(se,14),ae=!J&&!!re&&new Date<re,de=q.length>0||Object.keys(V).length>0,le=Z?Object(ie.b)(D._("Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Idea Pin is published. Edit the board and engagement settings any time.","editModal.editStoryPinModal.editTimeInformation","Let the user know how the edit settings are limited"),{numDays:14}):Object(ie.b)(D._("Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Story Pin is published. Edit the board and engagement settings any time.","editModal.editStoryPinModal.editTimeInformation","Let the user know how the edit settings are limited"),{numDays:14});return Object(c.jsx)(y.b,{accessibilityModalLabel:D._("Edit your previously saved pin","editModal.editStoryPinModal.accessibilityLabel","Accessible label for edit previously saved story pin modal"),footer:Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",children:[Object(c.jsx)(l.f,{"data-test-id":"delete-pin-button",children:Object(c.jsx)(l.g,{fullWidth:!0,color:"white",disabled:r,onClick:x,size:"lg",text:D._("Delete","editModal.editStoryPinModal.deleteButton","Delete button for previously saved story pin")})}),!!U&&Object(c.jsx)(l.f,{display:"flex",justifyContent:"center",children:Object(c.jsx)(R.a,{errorMessage:U,htmlFor:"pin-edit-generic-error"})}),Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",marginEnd:-1,marginStart:-1,children:[Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(l.g,{fullWidth:!0,onClick:v,size:"lg",text:D._("Cancel","editModal.editStoryPinModal.cancelButton","Cancel button to not save edits to previously saved story pin")})}),Object(c.jsx)(l.f,{"data-test-id":"edit-pin-save",paddingX:1,children:Object(c.jsx)(l.g,{fullWidth:!0,color:"red",onClick:()=>{if(A&&T){H(!0);const e=Object(te.c)({keyValueBlocks:V,listBlocks:q}),t=function(e){var t,i,n,o,s,r,a;return{metadata:{basics:null!==(t=e.metadata)&&void 0!==t&&t.basics?Object(te.a)(e.metadata.basics):void 0,diy_data:null===(i=e.metadata)||void 0===i?void 0:i.diy_data,pin_image_signature:null===(n=e.metadata)||void 0===n?void 0:n.pin_image_signature,pin_title:null===(o=e.metadata)||void 0===o?void 0:o.pin_title,recipe_data:null===(s=e.metadata)||void 0===s?void 0:s.recipe_data,template_type:null===(r=e.metadata)||void 0===r?void 0:r.template_type},pages:(a=e.pages,(null!=a?a:[]).map(e=>{var t,i;const n=(null!==(t=e.blocks)&&void 0!==t?t:[]).map(e=>{switch(e.type){case"story_pin_paragraph_block":return{block_style:e.block_style,style:e.style,text:e.text,type:0};case"story_pin_heading_block":return{block_style:e.block_style,level:e.level,style:e.style,text:e.text,type:1};case"story_pin_image_block":return{block_style:e.block_style,image_signature:e.image_signature,tracking_id:e.tracking_id,type:2};case"story_pin_video_block":return{block_style:e.block_style,tracking_id:e.tracking_id,type:3,video_signature:e.video_signature};default:return null}}).filter(Boolean);return n.length>0?{blocks:n,layout:e.layout,style:null!==(i=e.style)&&void 0!==i&&i.background_color?{background_color:e.style.background_color}:void 0}:null}).filter(Boolean))}}(T),n={...t,metadata:{...t.metadata,basics:e}},o={pin_id:M.id,story_pin:JSON.stringify(n)};b.a.create("StoryPinEditResource",o).callUpdate().then(e=>{const{resource_response:t}=e;a(M.id),i(t.data),E()}).catch(e=>{F(e.message),H(!1)})}else E()},size:"lg",text:D._("Done","editModal.editStoryPinModal.doneButton","Done button to save edits to previously saved story pin")})})]})]}),heading:D._("Edit Pin","editModal.editStoryPinModal.heading","Edit a previously saved story pin"),onDismiss:v,size:"md",children:h||!S.isLoaded||z||p?Object(c.jsx)(l.f,{paddingX:12,paddingY:9,children:Object(c.jsx)(l.U,{accessibilityLabel:D._("Loading edit information","editPinModal.editStoryPinModal.spinner","Accessible label for the edit pin loading icon"),show:!0})}):Object(c.jsx)(l.f,{overflow:"hidden",children:Object(c.jsx)(l.f,{marginEnd:-4,marginStart:-4,children:Object(c.jsx)(ee.a,{name:"web_story_pin_limit_edits",children:({anyEnabled:e})=>{var i,r,a,d,h,b;return Object(c.jsxs)(l.f,{display:"flex",minHeight:300,overflow:"hidden",paddingX:8,children:[Object(c.jsxs)(l.f,{alignItems:"center",direction:"column",display:"flex",flex:"shrink",paddingX:4,children:[Object(c.jsxs)(l.D,{wash:!0,rounding:4,width:120,children:[Object(c.jsx)(l.y,{alt:s,color:"#efefef",naturalHeight:null!==(i=L.height)&&void 0!==i?i:1,naturalWidth:null!==(r=L.width)&&void 0!==r?r:1,src:null!==(a=L.url)&&void 0!==a?a:""}),Object(c.jsx)(l.f,{position:"absolute",left:!0,top:!0,padding:2,children:Object(c.jsxs)(l.f,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"center",opacity:.8,padding:2,rounding:"pill",children:[Object(c.jsx)(l.w,{accessibilityLabel:Z?D._("Idea Pin icon","editModal.editStoryPinModal.storyPinIndicator","Idea Pin icon indicator"):D._("Story Pin icon","editModal.editStoryPinModal.storyPinIndicator","Story Pin icon indicator"),color:"darkGray",icon:"story-pin",size:12}),Object(c.jsx)(l.f,{marginStart:1,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:null===(d=M.story_pin_data)||void 0===d?void 0:d.page_count})})]})})]}),ae||!e?Object(c.jsx)(l.f,{"data-test-id":"edit-pages-button",paddingY:2,children:Object(c.jsx)(l.g,{onClick:_,text:D._("Edit pages","editModal.editStoryPinModal.editPagesButton","Edit pages label for story pin creation entry point")})}):null]}),Object(c.jsx)(l.f,{direction:"column",display:"flex",flex:"grow",paddingX:4,children:Object(c.jsx)(l.f,{marginBottom:-2,marginTop:-2,children:Object(c.jsx)(l.f,{maxHeight:500,overflow:"auto",paddingX:1,children:Object(c.jsxs)(l.f,{maxWidth:504,children:[e&&re&&Object(c.jsx)(l.f,{paddingY:2,children:ae?Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.bb,{size:"md",children:Object(ie.b)(D._("Edit until {{ editDate }}","editModal.editStoryPinModal.lastEditableDate","Let user know the last date this Pin can be edited on"),{editDate:Object(c.jsx)(oe.b,{dateFormatType:oe.a.NUMERIC,useUTC:!1,value:re},"noEditsTwoWeeksAfter-"+(null!==(h=M.created_at)&&void 0!==h?h:""))})}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(l.bb,{color:"gray",size:"md",children:le})})]}):Object(c.jsxs)(l.f,{children:[Object(c.jsx)(l.bb,{size:"md",children:D._("Editing","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",color:"gray",children:D._("Only board selection and engagement settings can be changed!","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")})})]})}),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:D._("Title","editModal.editStoryPinModal.titleLabel","Label for form input where users will input the title of their pin")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsxs)(l.f,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"between",padding:4,rounding:4,children:[Object(c.jsx)(l.bb,{color:"gray",lineClamp:1,children:I||""}),Object(c.jsx)(l.w,{accessibilityLabel:D._("Lock","editModal.editStoryPinModal.lockIcon.accessibilityLabel","Label for the lock icon to show that editing a story pin title is locked"),color:"darkGray",icon:"lock"})]})})]}),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:D._("Board","editModal.editStoryPinModal.boardLabel","Label for dropdown where users will choose their board")}),Object(c.jsx)(l.f,{paddingY:2,children:t?Object(c.jsx)(k.a,{board:t,isStoryPin:!0,onBoardChosen:f,onBoardCreate:m}):null})]}),Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:D._("Section","editModal.editStoryPinModal.sectionLabel","Label for dropdown where users will choose their section")}),Object(c.jsx)(l.f,{paddingY:2,children:(null==t?void 0:t.id)&&Object(c.jsx)(K.b,{isStoryPin:!0,board:t,onSectionChange:g,onSectionCreate:O,selectedSectionId:C,selectedSectionName:w})})]}),e&&de&&ae&&Object(c.jsx)($,{keyValueBlocks:V,listBlocks:q,onUpdateKeyValueBlock:G,onUpdateListBlocks:X,templateType:null==T||null===(b=T.metadata)||void 0===b?void 0:b.template_type}),M.can_delete_did_it_and_comments&&Object(c.jsxs)(l.f,{paddingY:2,children:[Object(c.jsx)(l.bb,{size:"md",children:D._("Comments and photos permissions","editModal.editStoryPinModal.commentsAndPhotosPermissionsLabel","Label for dropdown where users can toggle off permissions for comments and photos")}),Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(u,{isNoTitle:!0,commentsDisabled:o,onCommentChange:j})})]})]})})})})]})}})})})})}));function re({canEdit:e,onTitleChange:t,title:i,errorMessage:o}){const s=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"TitleField",children:Object(c.jsx)(l.bb,{size:"md",children:s._("Title","Label for editing title of pin","Label for editing title of pin")})})}),Object(c.jsx)(l.f,{column:12,mdColumn:8,children:e?Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.f,{children:Object(c.jsx)(l.db,{hasError:(o||"").length>0,id:"TitleField",onChange:t,size:"lg",value:i})}),!!o&&Object(c.jsx)(l.f,{children:Object(c.jsx)(R.a,{errorMessage:o,htmlFor:"pin-edit-title"})})]}):Object(c.jsx)(l.f,{column:12,mdColumn:8,paddingY:2,children:Object(c.jsx)(l.bb,{size:"md",weight:"bold",children:i})})})]})]})}function ae({onChangeWebsite:e,link:t,errorMessage:i}){const o=Object(d.c)();return Object(c.jsxs)(n.Fragment,{children:[Object(c.jsx)(l.q,{}),Object(c.jsxs)(l.f,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[Object(c.jsx)(l.f,{column:12,mdColumn:3,paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"WebsiteField",children:Object(c.jsx)(l.bb,{size:"md",children:o._("Website")})})}),Object(c.jsxs)(l.f,{column:12,mdColumn:8,children:[Object(c.jsx)(l.f,{children:Object(c.jsx)(l.db,{hasError:(i||"").length>0,id:"WebsiteField",onChange:e,size:"lg",value:t})}),!!i&&Object(c.jsx)(l.f,{children:Object(c.jsx)(R.a,{errorMessage:i,htmlFor:"pin-edit-website"})})]})]})]})}var de=i("MhBu"),le=i("x12c"),ce=i("Wrea"),ue=i("sH+O"),he=i("OSge"),be=i("KFEb"),pe=i("r8eU"),fe=i("qVfT"),je=i("NjDU"),ge=i("w70y"),me=i("eIuQ"),ye=i("pLLR"),xe=i("ANjH"),_e=i("c50B"),Oe=i("VqlB"),ve=i("EC67");function Se(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ce(e){return Boolean(e&&e.trim().length)}function we(e,t){const i=Ce(e),n=Ce(t);return(i||n)&&e!==t}class Ie extends n.Component{constructor(...e){var t,i,n,o,s,r,d,l,c,u,p,f,j,g,y,x,_,O;super(...e),Se(this,"state",{altText:(null===(t=this.props.pinResource.data)||void 0===t?void 0:t.alt_text)||"",board:(null===(i=this.props.pinResource.data)||void 0===i?void 0:i.board)||null,commentsDisabled:(null===(n=this.props.pinResource.data)||void 0===n?void 0:n.comments_disabled)||(null===(o=this.props.pinResource.data)||void 0===o?void 0:o.did_it_disabled)||!1,description:(null===(s=this.props.pinResource.data)||void 0===s||null===(r=s.description)||void 0===r?void 0:r.trim())||"",apiErrorMessage:null,link:(null===(d=this.props.pinResource.data)||void 0===d?void 0:d.link)||"",pinNoteText:(null===(l=this.props.pinResource.data)||void 0===l||null===(c=l.pin_note)||void 0===c?void 0:c.text)||"",sectionId:(null===(u=this.props.pinResource.data)||void 0===u||null===(p=u.section)||void 0===p?void 0:p.id)||null,sectionName:(null===(f=this.props.pinResource.data)||void 0===f||null===(j=f.section)||void 0===j?void 0:j.title)||null,showDeleteConfirmation:!1,carousel_data:(null===(g=this.props.pinResource.data)||void 0===g?void 0:g.carousel_data)||null,title:(null===(y=this.props.pinResource.data)||void 0===y?void 0:y.title)||"",isLoadingPin:!Boolean(this.props.pinResource.isLoaded),isProcessing:!1,currentIndex:void 0!==this.props.carouselSlotCurrentIndex?this.props.carouselSlotCurrentIndex:(null===(x=this.props.pinResource.data)||void 0===x||null===(_=x.carousel_data)||void 0===_?void 0:_.index)||0,shouldApplyTextToAll:!1,shouldDisableSave:!1,shouldShowCarouselSliders:!1,shouldShowValidationTitleError:!1,shouldShowValidationDescriptionError:!1,shouldShowValidationLinkFormatError:!1,shouldShowGenericUpdateError:!1,shouldShowValidationUserMentionTagsError:!1,userMentionTags:(null===(O=this.props.pinResource.data)||void 0===O?void 0:O.user_mention_tags)||[]}),Se(this,"onClickDeleteButton",()=>this.setState({showDeleteConfirmation:!0})),Se(this,"onHideConfirmation",()=>this.setState({showDeleteConfirmation:!1})),Se(this,"updateCarouselSlotIndex",()=>{const{carouselSlotCurrentIndex:e}=this.props;this.setState({currentIndex:void 0!==e?e:this.props.pinResource.data&&this.props.pinResource.data.carousel_data&&this.props.pinResource.data.carousel_data.index||0})}),Se(this,"handleBoardChange",e=>{const{board:{id:t}}=this.state;e.id!==t&&this.setState({board:e,sectionId:null,sectionName:null})}),Se(this,"createBoard",e=>{const{createBoard:t}=this.props,{board:i}=this.state;!i.id&&i.name&&e&&t(i.name,e).then(e=>{if(this._isMounted){const{sectionId:t,sectionName:i}=this.state;!t&&i?(this.setState({board:e}),this.createSection()):(this.handleBoardChange(e),this.handleSave())}})}),Se(this,"handleBoardCreateClick",e=>{if(!e)return;const t={name:e,privacy:h.a.BoardPrivacy.PUBLIC,access:"write"};this.setState({board:t,sectionId:null,sectionName:null})}),Se(this,"createSection",()=>{const{board:e,sectionName:t}=this.state;if(!t)return;if(!e.id)return void this.createBoard();const i={boardId:e.id,name:t},{createSection:n}=this.props;n(i).then(e=>{this._isMounted&&(this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null}),this.handleSave())}).catch(()=>{this.setState({shouldShowGenericUpdateError:!0,apiErrorMessage:null})})}),Se(this,"handleSectionCreateClick",e=>{if(0===e.length)return;const{board:t}=this.state;t&&this.setState({sectionId:null,sectionName:e})}),Se(this,"handleSectionChange",e=>this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null,shouldShowGenericUpdateError:!1})),Se(this,"handleDeletePin",()=>{const{advertiser_id:e,changeBoardPinCount:t,changeUserPinCount:i,onDelete:n,onHide:o,pinId:s,pinResource:{data:r},removeBoardlessPin:a,viewer:d}=this.props,l={...e?{advertiser_id:e}:{},id:s};return b.a.create("PinResource",l).callDelete().then(()=>{if(this._isMounted){if(!r)return;const{board:{id:e}={},pinner:{id:a}={},section:d}=r;t({boardId:e,sectionId:d&&d.id||void 0,increment:-1}),i({userId:a,increment:-1}),le.a.instance.publish(e,"pinDeleted",s),le.a.instance.publish(a,"pinDeleted"),le.a.instance.publish(s,"pinDeleted"),o(),n&&n()}d.id&&a(d.id,s)})}),Se(this,"sanitizeCarouselData",e=>{let{carousel_data:t}=this.state;if(e&&(t=e),t){const{carousel_slots:e}=t;if(e){const t={carousel_slots:[]};return e.forEach(e=>{const i={};i.description=e.details||"",i.title=e.title||"",i.link=e.link||"",t.carousel_slots.push(i)}),t}}return null}),Se(this,"triggerBoardAndSectionCreate",e=>()=>{const{board:t,sectionId:i,sectionName:n}=this.state;t&&!t.id&&t.name?this.createBoard(e):!i&&n?this.createSection():this.handleSave()}),Se(this,"logPinEditEvent",(e,t,i,n,o)=>{const s={},{pinId:r,view:a,viewParameter:d}=this.props,{userMentionTags:l}=this.state;if(s.objectId=r,s.num_user_mention_tags=l.length,e&&(s.board_was_modified=!0),!e&&t&&(s.board_section_was_modified=!0),i){const{description:e}=this.state,{description:t}=o;s.original_pin_description=t,s.edited_pin_description=e}if(n){const{carousel_data:e}=this.state,{carousel_data:t}=o;s.original_carousel_data=JSON.stringify(this.sanitizeCarouselData(t)),s.edited_carousel_data=JSON.stringify(this.sanitizeCarouselData(e))}Object(L.b)(2,{component:208,view:a,viewParameter:d,...s})}),Se(this,"handleSave",()=>{this.setState({apiErrorMessage:null,isProcessing:!0});const{advertiser_id:e,completeResourceFetch:t,invalidatePinResource:i,pinId:n,pinResource:{data:o},onHide:s,removeBoardlessPin:r,updatePinNote:a,viewer:d}=this.props;if(!o)return;const{alt_text:l,board:c,comments_disabled:u,did_it_disabled:h,title:p,description:f,link:j,pin_note:g,section:y,carousel_data:x}=o,_=null==g?void 0:g.text,{carousel_data:O,shouldShowValidationLinkFormatError:v}=this.state;let S;if(O){const e=this.sanitizeCarouselData();e&&(S=JSON.stringify(e))}const{altText:C,board:w,commentsDisabled:I,currentIndex:E,title:k,description:P,pinNoteText:B,sectionId:D,carousel_data:M,userMentionTags:T}=this.state,R=w||c,L=v?j:this.state.link,A={alt_text:C,board_id:null==R?void 0:R.id,board_section_id:D,carousel_data_json:S,description:P,disable_comments:I,disable_did_it:I,id:n,link:L,title:k,user_mention_tags:JSON.stringify(T),...e?{advertiser_id:e}:{}},N=y&&y.id||null,U=null==R?void 0:R.id,F=null==c?void 0:c.id,z=we(l,C),H=F!==U,V=(Boolean(N)||Boolean(D))&&N!==D,W=we(p,k),q=we(f,P),K=we(j,L),Y=Boolean(M)&&Boolean(x)&&!m()(M,x),Q=u!==I||h!==I,G=we(_,B);z||H||V||W||q||G||K||Y||Q?(G&&a(n,_,B),b.a.create("PinResource",A).callUpdate().then(({resource_response:e})=>{if(this._isMounted){const{changeBoardPinCount:l,onSubmit:c,pinId:u,pinMoved:h}=this.props;var n,a;if((H||V)&&U&&F)h({selectedPinIds:[u],source:{boardId:F,sectionId:N},target:{boardId:U,sectionId:D}}),l({boardId:U,sectionId:D||void 0,increment:1}),l({boardId:F,sectionId:N||void 0,increment:-1}),d.id&&"quick_saves"===(null===(n=o.board)||void 0===n?void 0:n.layout)&&r(d.id,u);if(c&&U&&null!=R&&R.url)c({boardId:U,title:null!==(a=R.name)&&void 0!==a?a:"",sectionId:D,url:R.url});s(),i(u);const{data:b}=e;b.carousel_data&&(b.carousel_data.index=E),t(b),this.logPinEditEvent(H,V,q,Y,o)}}).catch(()=>{const{shouldShowValidationTitleError:e,shouldShowValidationDescriptionError:t,shouldShowValidationLinkFormatError:i}=this.state;this.setState({isProcessing:!1,shouldShowGenericUpdateError:!e&&!t&&!i})})):(s(),i(n)),this.setState({isProcessing:!1})}),Se(this,"handleTextChanges",(e,t)=>{const{carousel_data:i}=this.state;if(!i)return;const n=a()(i),{carousel_slots:o=[]}=n,{currentIndex:s,shouldApplyTextToAll:r,description:d,link:l,title:c}=this.state,u=this.valueIsValidForType(e,t);switch(r?o.forEach(i=>i[t]=e):o[s]&&(o[s][t]=e),t){case"details":const t=0===s?e:d;this.setState({description:t,carousel_data:n||null,shouldShowValidationDescriptionError:!u,shouldShowGenericUpdateError:!1});break;case"link":const i=0===s?e:l;this.setState({link:i,carousel_data:n||null,shouldShowValidationLinkFormatError:!u,shouldShowGenericUpdateError:!1});break;case"title":const o=0===s?e:c;this.setState({title:o,carousel_data:n||null,shouldShowValidationTitleError:!u,shouldShowGenericUpdateError:!1})}}),Se(this,"handleDescriptionChange",({value:e,userMentionTags:t})=>{const i=this.valueIsValidForType(e,"description"),n=this.valueIsValidForType(t,"userMentionTags");t.length<this.state.userMentionTags.length&&Object(L.b)(8906,{element:116,tag_type:1}),this.setState({description:e,userMentionTags:t,shouldShowValidationDescriptionError:!i,shouldShowValidationUserMentionTagsError:!n,shouldShowGenericUpdateError:!1})}),Se(this,"handleCarouselDetailsChange",({value:e})=>{this.handleTextChanges(e,"details")}),Se(this,"handleTitleChange",({value:e})=>{const t=this.valueIsValidForType(e,"title");this.setState({title:e,shouldShowValidationTitleError:!t,shouldShowGenericUpdateError:!1})}),Se(this,"handleCarouselTitleChange",({value:e})=>{this.handleTextChanges(e,"title")}),Se(this,"handleAltTextChange",({value:e})=>{this.setState({altText:e})}),Se(this,"valueIsValidForType",(e,t)=>{switch(t){case"details":case"description":return e.length<=500;case"link":return e.length>=0&&0===Object(_e.s)([Object(_e.r)({message:this.props.i18n._("Not a valid url.","Validation error for an improperly formated url","Validation error for an improperly formated url")})],e).length;case"title":return e.length<=100;case"userMentionTags":return e.length<=5;default:return!0}}),Se(this,"handleWebsiteChange",({value:e})=>{const t=this.valueIsValidForType(e,"link");this.setState({link:e,shouldDisableSave:!t,shouldShowValidationLinkFormatError:!t,shouldShowGenericUpdateError:!1})}),Se(this,"handleCarouselWebsiteChange",({value:e})=>{this.handleTextChanges(e,"link")}),Se(this,"handleCommentChange",e=>this.setState({commentsDisabled:!e.value})),Se(this,"handleShouldApplyToAll",e=>{if(e){const{currentIndex:t=0,carousel_data:i}=this.state;if(!i)return;const n=a()(i),{carousel_slots:o=[]}=n,{details:s,link:r,title:d}=o[t];o.forEach(e=>{e.details=s,e.title=d,e.link=r}),this.setState({carousel_data:n,shouldApplyTextToAll:e})}else this.setState({shouldApplyTextToAll:e})}),Se(this,"handleCarouselSlider",e=>{const{carousel_data:t}=this.state,i=t&&t.carousel_slots&&t.carousel_slots.length||1;e>=0&&e<i&&this.setState({currentIndex:e})}),Se(this,"handleClickStoryPinPages",()=>{const{pinResource:{data:e},history:t}=this.props;e&&t.push(`/story-pin-builder/${e.id}/edit`)}),Se(this,"handleMouseEnter",()=>{this.setState({shouldShowCarouselSliders:!0})}),Se(this,"handleMouseLeave",()=>{this.setState({shouldShowCarouselSliders:!1})})}componentDidMount(){this._isMounted=!0,this.updateCarouselSlotIndex()}componentDidUpdate(e){const{pinResource:{data:t,isLoaded:i},carouselSlotCurrentIndex:n}=this.props;var o;t&&i!==e.pinResource.isLoaded&&this.setState({altText:t.alt_text,board:t.board,commentsDisabled:t.comments_disabled||t.did_it_disabled,description:t.description&&t.description.trim(),isLoadingPin:!1,link:t.link,pinNoteText:(null===(o=t.pin_note)||void 0===o?void 0:o.text)||"",sectionId:(t.section||{}).id,sectionName:(t.section||{}).title,title:t.title,carousel_data:t.carousel_data,currentIndex:void 0!==n?n:t.carousel_data&&t.carousel_data.index||0,shouldApplyTextToAll:!1,userMentionTags:t.user_mention_tags||[]})}componentWillUnmount(){this._isMounted=!1}showErrorToast(e){this.props.toastManagerContext.showOneToast(({onHide:t})=>Object(c.jsx)(O.a,{color:"red",duration:5e3,onHide:t,text:e})),this.props.onHide()}getCurrentUserId(e){return e.isAuth?e.id:""}render(){var e;const{disableDelete:t,onHide:i,pinResource:n,pinId:o,requestContext:r,viewer:a}=this.props,{altText:d,apiErrorMessage:h,board:b,commentsDisabled:p,description:f,link:j,pinNoteText:g,sectionId:m,sectionName:x,showDeleteConfirmation:_,title:O,isLoadingPin:v,isProcessing:S,carousel_data:C,shouldApplyTextToAll:w,currentIndex:k,shouldDisableSave:P,shouldShowCarouselSliders:D,shouldShowValidationTitleError:M,shouldShowValidationDescriptionError:T,shouldShowValidationLinkFormatError:R,shouldShowGenericUpdateError:L,shouldShowValidationUserMentionTagsError:A,userMentionTags:N}=this.state;if(_)return Object(c.jsx)(I,{onDeletePin:this.handleDeletePin,onDismiss:this.onHideConfirmation});const F=n.data||{},z=!!(C&&C.carousel_slots&&C.carousel_slots.length>1),H=C&&C.carousel_slots&&C.carousel_slots.length>0&&C.carousel_slots[k]||{},{details:K="",link:Q="",title:G=""}=H,X=!!(F&&F.story_pin_data_id&&F.story_pin_data),J=F&&(F.access||[]).includes("write")||this.props.canEdit||!!b&&Object(s.a)({action:4,board:b}),Z=e=>{const t=this.getCurrentUserId(e),i=this.props.canEdit&&this.props.advertiserOwnerUserId?this.props.advertiserOwnerUserId:t;return J&&!F.is_repin&&!X&&(z||!C)&&(F.native_creator&&F.native_creator.id===i||z&&F.pinner&&F.pinner.id===i||F.link_domain&&F.link_domain.official_user&&F.link_domain.official_user.id===i||!!F.domain&&F.pinner&&F.pinner.id===i&&F.pinner.domain_url&&F.pinner.domain_url.includes(F.domain))},$=F&&F.images&&F.images["474x"]||{},ee=new pe.b(r,"web_story_pin_creator").enabledWithNoActivation(),te=new pe.b(r,"web_alt_text").enabledWithNoActivation(),ie=F.story_pin_data&&F.story_pin_data.metadata&&F.story_pin_data.metadata.version?Object(ue.b)(F.story_pin_data.metadata.version,he.c):null,ne=null!=ie&&ie>=0,oe=!!F.story_pin_data&&!!F.story_pin_data.metadata&&!!F.story_pin_data.metadata.is_editable&&F.native_creator&&F.native_creator.id===this.getCurrentUserId(a);if(X&&ee&&ne&&oe)return Object(c.jsx)(se,{apiErrorMessage:h,board:b,commentsDisabled:p,description:f,disableDelete:t,isLoadingPin:v,isProcessing:S,onChangeBoard:this.handleBoardChange,onChangeComment:this.handleCommentChange,onChangeSection:this.handleSectionChange,onClickBoardCreate:this.handleBoardCreateClick,onClickDeleteButton:this.onClickDeleteButton,onClickEditPages:this.handleClickStoryPinPages,onClickSectionCreate:this.handleSectionCreateClick,onHide:i,pinResource:n,sectionId:m,sectionName:x,title:O,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(a)});const de=Z(a)?Object(c.jsx)(re,{canEdit:J,onTitleChange:z?this.handleCarouselTitleChange:this.handleTitleChange,title:z&&G?G:O,errorMessage:M?Object(me.b)(z):""}):null,le=(J||a.isAuth&&(F.pinner||{}).id===a.id)&&Z(a)?Object(c.jsx)(U,{canAddUserMentionTags:!z,canEdit:J,description:(z?K:f)||"",errorMessage:T?Object(me.a)(z):A?Object(me.d)(z):"",initialMentions:N,label:this.props.i18n._("Description","Label for editing description","Label for editing description"),placeholder:this.props.i18n._("Tell us about this Pin...","Placeholder for editing description","Placeholder for editing description"),onDescriptionChange:z?this.handleCarouselDetailsChange:this.handleDescriptionChange}):null,ce=Object(c.jsx)(q,{isCollaborative:!(null==b||!b.is_collaborative),onPinNoteChange:({value:e})=>{this.setState({pinNoteText:e})},pinNoteText:g}),be=(e=>Z(e)&&!(F.aggregated_pin_data&&F.aggregated_pin_data.is_shop_the_look))(a)?Object(c.jsx)(ae,{link:z&&Q?Q:j,onChangeWebsite:z?this.handleCarouselWebsiteChange:this.handleWebsiteChange,errorMessage:R?Object(me.c)(z):""}):null,fe=z?Object(c.jsxs)(l.f,{display:"flex",justifyContent:"end",paddingX:4,paddingY:3,alignItems:"end",children:[Object(c.jsx)(l.f,{paddingY:2,children:Object(c.jsx)(l.z,{htmlFor:"applyTextToAll",children:Object(c.jsx)(l.bb,{children:this.props.i18n._("Apply text to all","Apply title, description, link to all cards","Apply title, description, link to all cards")})})}),Object(c.jsx)(l.f,{paddingX:2,paddingY:2,children:Object(c.jsx)(l.W,{onChange:e=>this.handleShouldApplyToAll(e.value),id:"applyTextToAll",switched:w})})]}):null,je=Z(a)&&te?Object(c.jsx)(E,{canEdit:J,onAltTextChange:this.handleAltTextChange,altText:d}):null,ge=F.can_delete_did_it_and_comments?Object(c.jsx)(u,{commentsDisabled:p,onCommentChange:this.handleCommentChange}):null,ye=!!a.has_quicksave_board&&!!a.boardCount&&a.boardCount<2,xe="quick_creates"===(null===(e=F.board)||void 0===e?void 0:e.layout);return Object(c.jsx)(y.b,{heading:this.props.i18n._("Edit this Pin","EditPinModal.ModalHeading.EditThisPin","Edit a previously saved pin"),accessibilityModalLabel:this.props.i18n._("Edit your previously saved pin","EditPinModal.ModalHeading.AccessibleLabel","Accessible label for edit previously saved pin modal"),size:ye?"sm":"lg",onDismiss:i,footer:Object(c.jsx)(W,{apiErrorMessage:h,shouldShowGenericUpdateError:L,onClickDeleteButton:this.onClickDeleteButton,disableDelete:t,onHide:i,shouldDisableSave:P,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(a)}),children:v||!n.isLoaded||S?Object(c.jsx)(l.f,{display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.U,{accessibilityLabel:this.props.i18n._("loading","EditPinModal.LoadingPin.Spinner","Accessible label for the edit pin loading icon"),show:!0})}):Object(c.jsxs)(l.f,{display:"flex",justifyContent:ye?"center":"between",minHeight:350,paddingX:4,children:[ye?null:Object(c.jsxs)(l.f,{column:12,mdColumn:9,children:[Object(c.jsx)(B,{board:b||F.board,canEdit:J,isOriginallyQuickCreatesBoard:xe,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick,viewerId:a.id||""}),Object(c.jsx)(Y,{board:b||F.board,canEdit:J,onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:m,sectionName:x,currentSection:F.section}),de,le,be,fe,je,ce,ge]}),Object(c.jsx)(V,{isCarousel:z,shouldShowCarouselSliders:D,onCarouselSlide:this.handleCarouselSlider,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,currentIndex:this.state.currentIndex,carouselData:this.state.carousel_data,pinId:o,description:f,image:$})]})})}}const Ee=(e,t)=>({field_set_key:"detailed",id:e,preserve_component_state:t});t.a=Object(xe.compose)(v.c,Object(o.connect)((function(e){const{advertiser:t,viewer:i}=e;return i.isAuth&&t?{advertiser_id:t.id,...t.owner_user_id!==i.id?{advertiserOwnerUserId:t.owner_user_id}:{},viewer:i}:{viewer:i}}),e=>({changeBoardPinCount:t=>e(Object(ce.d)(t)),changeUserPinCount:t=>e(Object(je.c)(t)),completeResourceFetch:t=>e(Object(f.b)("PinResource",Ee(t.id,!1),t)),createBoard:(t,i)=>e(function(e,t){const i={name:e,privacy:h.a.BoardPrivacy.PUBLIC};return e=>b.a.create("BoardResource",i).callCreate().then(i=>{const n=i.resource_response.data;return e(t.username&&Object(f.f)("BoardsResource",Object(p.a)(t.username,!1))),n})}(t,i)),createSection:t=>e(Object(j.a)(t)),invalidatePinResource:t=>e(Object(f.f)("PinResource",Ee(t,!0))),removeBoardlessPin:(t,i)=>e(Object(de.a)({feedId:t,feedType:be.a.BOARDLESS_PINS,itemIds:[i],itemType:"pin"})),pinMoved:Object(xe.bindActionCreators)(Oe.b,e),updatePinNote:(t,i,n)=>e(Object(fe.a)(t,i,n))})))((function(e){const t=Object(d.c)(),i=Object(ge.a)({name:"PinResource",options:Ee(e.pinId,!0)});return Object(c.jsx)(Ie,{...e,history:Object(ve.h)(),pinResource:i,requestContext:Object(ye.d)(),i18n:t})}))},"6HHy":function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("yweb"),o=i("vvax"),s=i("n6mq"),r=i("nKUr");function a({onUpdate:e,showLabel:t=!0,value:i}){const a=Object(n.c)(),d=[];for(let n=1;n<=50;n+=1)d.push({value:String(n),label:Object(o.b)(a.ngettext("{{ servings }} serving","{{ servings }} servings",n,"storyboard.detailsList.field.servings","Option for number of servings a story pin recipe will provide"),{servings:n}).join("")});return Object(r.jsx)(s.f,{width:"100%",display:"flex",children:Object(r.jsx)(s.f,{width:"100%",position:"relative",children:Object(r.jsx)(s.S,{size:"lg",id:"servings",name:"servings",label:t?a._("Servings","storyboard.detailsList.field.servings","Header title for serving count entry for story pin recipe"):void 0,placeholder:a._("Pick a serving size","storyboard.detailsList.recipe","Placeholder caption for servings count input in story pin recipe"),value:i,options:d,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},"8Enz":function(e,t,i){i.d(t,"a",(function(){return r}));var n=i("yweb"),o=i("n6mq"),s=i("nKUr");function r({onUpdate:e,showLabel:t=!0,value:i}){const r=Object(n.c)(),a=[{label:r._("Easy","storyboard.detailsList.field.difficulty","Easy difficulty rating for story pin"),value:String(1)},{label:r._("Medium","storyboard.detailsList.field.difficulty","Medium difficulty rating for story pin"),value:String(2)},{label:r._("Difficult","storyboard.detailsList.field.difficulty","Hard difficulty rating for story pin"),value:String(3)}];return Object(s.jsx)(o.f,{width:"100%",display:"flex",children:Object(s.jsx)(o.f,{width:"100%",children:Object(s.jsx)(o.S,{size:"lg",id:"servings",name:"servings",label:t?r._("Difficulty","storyboard.detailsList.field.difficulty","Header title for difficulty rating entry for story pin"):void 0,placeholder:r._("Pick a difficulty rating","storyboard.detailsList.field","Placeholder caption for difficulty rating input in story pin"),value:i,options:a,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},"8cMa":function(e,t,i){var n=i("yweb"),o=i("n6mq"),s=i("nKUr");t.a=function({type:e}){const t=Object(n.c)(),i={group:{accessibilityLabel:t._("group board","Board picker group board icon","Board picker group board icon"),icon:"people"},protected:{accessibilityLabel:t._("protected board","Board picker protected board icon","Board picker protected board icon"),icon:"protect"},secret:{accessibilityLabel:t._("secret board","Board picker secret board icon","Board picker secret board icon"),icon:"lock"},sections:{accessibilityLabel:t._("board with sections","Board picker board with sections icon","Board picker board with sections icon"),icon:"arrow-forward"},sectionsInline:{accessibilityLabel:t._("board with sections","Board picker board with sections icon","Board picker board with sections icon"),icon:"arrow-down"}}[e];return Object(s.jsx)(o.f,{marginStart:1,children:Object(s.jsx)(o.f,{marginStart:2,children:"sections"===e||"sectionsInline"===e?Object(s.jsx)(o.w,{accessibilityLabel:i.accessibilityLabel,icon:i.icon,size:"12",color:"darkGray"}):Object(s.jsx)(o.w,{accessibilityLabel:i.accessibilityLabel,icon:i.icon,size:16,color:"darkGray"})})})}},"9QW3":function(e,t,i){i.d(t,"a",(function(){return r}));const n={row:0,section:0},o={row:-1,section:-1},s=()=>{};class r{constructor(e){this.index=Object.assign({},n),this.sections=e,this.updateCallback=s,this.selectItem=s}getIndex(){return this.index}isAtStart(){const{row:e,section:t}=this.index;return 0===e&&0===t}isAtEnd(){const{row:e,section:t}=this.index,i=this.sections[t]||[];return this.sections.length===t+1&&i.length===e+1}next(){if(this.isAtEnd())return;const{row:e,section:t}=this.index;e===o.row&&t===o.section?this.index=Object.assign({},n):this.sections[t].length>e+1?this.index.row+=1:(this.index.section+=1,this.index.row=0),this.updateCallback(!0)}prev(){if(this.isAtStart())return;const{row:e,section:t}=this.index;if(e===o.row&&t===o.section)this.index=Object.assign({},n);else if(e>0)this.index.row-=1;else{const e=this.index.section-1;this.index={section:e,row:this.sections[e].length-1}}this.updateCallback(!0)}select(){const{row:e,section:t}=this.index;this.selectItem((this.sections[t]||[])[e])}setInactive(){this.index=Object.assign({},o),this.updateCallback()}setSelectItem(e){this.selectItem=e}setUpdateCallback(e){this.updateCallback=e}updateIndex(e){this.index=e,this.updateCallback()}}},GBVV:function(e,t,i){i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));var n=i("n6mq"),o=i("nKUr");const s={__style:{margin:"0 10px",borderRight:"3px solid transparent",borderTop:"3px solid #fff",animation:"spin .8s linear infinite"}};function r(){return Object(o.jsx)(n.f,{alignItems:"center",color:"red",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",rounding:8,children:Object(o.jsx)(n.f,{dangerouslySetInlineStyle:s,display:"inlineBlock",height:18,position:"relative",rounding:"circle",width:18})})}function a({disabled:e,name:t,onClick:i,size:s,submitting:a,text:d}){return Object(o.jsxs)(n.f,{display:"flex",position:"relative",children:[a&&Object(o.jsx)(r,{}),Object(o.jsx)(n.g,{color:"red",disabled:e||a,name:t,onClick:i,size:s,type:"submit",text:d})]})}},IBrh:function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("q1tI"),o=i("mEMi"),s=(i("9QW3"),i("n6mq")),r=i("nKUr");function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d extends n.Component{constructor(e){super(e),a(this,"setSelectedItemRef",e=>{this.selectedItemRef=e}),a(this,"handleIndexUpdate",e=>{const{indexManager:t}=this.props;this.setState({selectedIndex:t.getIndex(),selectionMovedByKeyboard:!!e})}),a(this,"handleSelectItem",e=>()=>{const{disabled:t,onSelectItem:i}=this.props;t||i(e)}),a(this,"handleMouseEnter",e=>()=>{const{disabled:t,indexManager:i}=this.props;t||i.updateIndex(e)}),a(this,"handleMouseLeave",()=>{const{disabled:e,indexManager:t}=this.props;e||t.setInactive()}),a(this,"renderItems",(e,t)=>{const{renderItem:i}=this.props,{selectedIndex:n}=this.state,{row:o,section:a}=n||{},{customProps:d={},items:l,renderItem:c}=e,{isDisabled:u=(e=>!1)}=d,h=t===a,b=c||i;return b&&l.map((e,i)=>{const n=u(e),a={section:t,row:i},l=h&&i===o;return Object(r.jsx)(s.f,{"data-test-id":"board-selection",ref:!n&&l?this.setSelectedItemRef:null,children:n?b({item:e,hovered:l,sectionProps:d}):Object(r.jsx)(s.ab,{fullWidth:!1,onMouseEnter:this.handleMouseEnter(a),onMouseLeave:this.handleMouseLeave,onTap:this.handleSelectItem(e),rounding:2,children:b({item:e,hovered:l,sectionProps:d})})},i)})}),a(this,"renderSections",()=>{const{renderSectionHeader:e,sections:t}=this.props;return t.map((t,i)=>Object(r.jsxs)(s.f,{children:[e&&e(t,i),this.renderItems(t,i)]},i))});const{indexManager:t}=this.props;this.state={selectedIndex:t.getIndex(),selectionMovedByKeyboard:!1},t.setUpdateCallback(this.handleIndexUpdate)}componentDidUpdate(e){const{containerRef:t}=this;if(this.selectedItemRef&&this.state.selectionMovedByKeyboard&&t){const e=this.selectedItemRef;if(!(e instanceof HTMLElement))return;const i=e.getBoundingClientRect(),n=i.top,o=i.bottom,s=t.getBoundingClientRect(),r=s.top;o>=s.bottom?e.scrollIntoView(!1):n<=r&&e.scrollIntoView(!0)}e.indexManager!==this.props.indexManager&&this.props.indexManager.setUpdateCallback(this.handleIndexUpdate)}render(){const{grow:e=!1,maxHeight:t,fetchMore:i}=this.props;return Object(r.jsx)(o.a,{fetchMore:i,children:({setRef:i,onScroll:n})=>Object(r.jsx)(s.f,{flex:e?"grow":void 0,height:e?"100%":void 0,maxHeight:t,onScroll:n,overflow:"auto",ref:e=>{this.containerRef=e,i(e)},children:this.renderSections()})})}}},JKZO:function(e,t,i){i.d(t,"a",(function(){return d}));var n=i("2K7C"),o=i("MKeS"),s=i("nKUr"),r=i.n(s);const a=Object(o.a)({resolved:{},chunkName:()=>"EditorWithMentionsInternal",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!i.m[t]},importAsync:()=>i.e("EditorWithMentionsInternal").then(i.bind(null,"AO8i")),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return i(t)},resolve(){return"AO8i"}});function d(e){return Object(s.jsx)(a,{...e,fallback:Object(s.jsx)(n.a,{})})}},Joxa:function(e,t,i){i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return r}));const n=[0,2,1];function o(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map(e=>{const{heading:t,blocks:i}=e;return{heading:t,blocks:(null!=i?i:[]).map(e=>({text:e.text?e.text:"",type:9})),type:7}}):[];return{key_value_blocks:i&&i.length>0?i.map(e=>({category_type:e.category_type,type:8,value:e.value})):[],list_blocks:n}}function s(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map(e=>{const{heading:t,blocks:i}=e;return{heading:t,items:(null!=i?i:[]).map(e=>e.text?e.text:"")}}):[];return{keyValueBlocks:i&&i.length>0?i.reduce((e,t)=>{const{category_type:i,value:n}=t;return e[null!=i?i:""]=n,e},{}):{},listBlocks:n}}function r(e){const{keyValueBlocks:t,listBlocks:i}=e;if(!t&&!i)return null;return{list_blocks:i?i.map(e=>{const{heading:t,items:i}=e;let n=[];return i&&(n=i.map(e=>({text:e,type:9}))),{blocks:n,heading:t,type:7}}):[],key_value_blocks:(t?Object.keys(t).map(e=>{const i=t[e],o=Number.parseInt(e,10),s=n.indexOf(o)>-1&&i===Number.parseInt(i,10).toString();return i&&s?{value:i,category_type:o,type:8}:null}):[]).filter(Boolean)}}},NXrh:function(e,t,i){i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return m}));var n=i("q1tI"),o=i("/MKj"),s=i("Sihc"),r=i("rrvb"),a=i("0BOE"),d=i("jdx6"),l=i("yweb"),c=i("w70y"),u=i("n6mq"),h=i("nKUr");function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p="NO_SECTION_VALUE";function f({section:e,hovered:t,searchQuery:i}){return Object(h.jsxs)(u.f,{children:[Object(h.jsx)(u.f,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:Object(h.jsx)(u.f,{flex:"grow",children:Object(h.jsx)(u.bb,{weight:"bold",children:Object(d.b)(i,e.title)})})}),e.id===p&&Object(h.jsx)(u.q,{})]})}class j extends n.Component{constructor(...e){super(...e),b(this,"state",{searchQuery:""}),b(this,"getPickerSections",()=>{const{searchQuery:e}=this.state,{sectionsResource:t,mergingFromSectionId:i}=this.props;let n=t&&t.data||[];return n=i?n.filter(e=>e.id!==i):[{id:p,title:this.props.i18n._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")},...n],e.length>=2&&(n=Object(a.a)(n,e,"title")),[{items:n}]}),b(this,"createBtnDisabled",()=>{const{sectionsResource:e}=this.props,{searchQuery:t}=this.state;return!(!e||!e.data)&&e.data.some(e=>{var i;return(null===(i=e.title)||void 0===i?void 0:i.toLowerCase())===t.toLocaleLowerCase()})}),b(this,"handleSectionCreate",()=>{const{board:e,onSectionChange:t,sectionsResource:i,dispatch:n,onSectionCreate:o}=this.props,{searchQuery:r}=this.state;o?o(r):n&&e.id&&n(Object(s.a)({boardId:e.id,name:r})).then(e=>{i&&i.refresh(),this.setState({searchQuery:""}),t(e)})}),b(this,"handleSectionSelected",e=>{const{onSectionChange:t}=this.props;e.id===p?(t(null),this.setState({searchQuery:""})):(t(e),this.setState({searchQuery:""}))}),b(this,"handleSearchQueryUpdate",e=>{this.setState({searchQuery:e})}),b(this,"renderRow",({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return Object(h.jsx)(f,{hovered:t,searchQuery:i,section:e})})}componentDidUpdate(e){const t=e.selectedSectionId,{selectedSectionId:i}=this.props;if(i!==t){const{sectionsResource:e}=this.props;e&&e.refresh()}}render(){const{isStoryPin:e,sectionsResource:t,selectedSectionId:i,mergingFromSectionId:n,selectedSectionName:o}=this.props,{searchQuery:s}=this.state;let a=n?this.props.i18n._("Pick a section","default dropdown option for selecting a board section to merge to","default dropdown option for selecting a board section to merge to"):this.props.i18n._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit");if(i){let e;t&&t.data&&(e=t.data.find(e=>e.id===i)),a=e&&e.title||a}else o&&(a=o);return Object(h.jsxs)(u.f,{children:[Object(h.jsx)(u.U,{accessibilityLabel:this.props.i18n._("loading section picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!!t&&!t.isLoaded}),(!t||t&&t.isLoaded)&&Object(h.jsx)(r.a,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:a,isStoryPin:e,onCreate:n?null:this.handleSectionCreate,onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleSectionSelected,renderRow:this.renderRow,searchQuery:s,sections:this.getPickerSections()})]})}}function g(e){const t=Object(l.c)();return Object(h.jsx)(j,{...e,dispatch:Object(o.useDispatch)(),i18n:t})}function m(e){const t=Object(c.a)({name:"BoardSectionsRepinResource",options:{board_id:e.board.id},allowStale:!1});return Object(h.jsx)(g,{...e,sectionsResource:t})}},NdQN:function(e,t,i){var n=i("q1tI"),o=i("JW66"),s=(i("9QW3"),i("n6mq")),r=i("yweb"),a=i("nKUr");function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class l extends n.Component{constructor(...e){super(...e),d(this,"setInputRef",e=>{e&&(this._input=e)}),d(this,"handleKeyDown",e=>{const{disabled:t,indexManager:i}=this.props;if(!t)switch(e.which){case o.a.KeyCode.ENTER:case o.a.KeyCode.NUMPAD_ENTER:e.preventDefault(),i.select();break;case o.a.KeyCode.UP:e.preventDefault(),i.prev();break;case o.a.KeyCode.DOWN:e.preventDefault(),i.next()}})}componentDidMount(){this._input&&this._input.focus()}render(){const{onChange:e,value:t}=this.props;return Object(a.jsx)("div",{onKeyDown:this.handleKeyDown,role:"presentation",style:{width:"100%"},children:Object(a.jsx)(s.Q,{accessibilityLabel:"",id:"pickerSearchField",onChange:({value:t})=>e(t),placeholder:this.props.i18n._("Search","search bar placeholder text","search bar placeholder text"),ref:this.setInputRef,size:"lg",value:t})})}}t.a=function(e){const t=Object(r.c)();return Object(a.jsx)(l,{...e,i18n:t})}},NjDU:function(e,t,i){function n(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}function o(e){return{type:"UPDATE_USER_FOLLOWING_COUNT",payload:e}}function s(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}function r(e,t){return{type:"UPDATE_USER_SOCIAL_NETWORK",payload:{socialNetworkName:e,connected:t}}}i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return r})),i.d(t,"g",(function(){return a})),i.d(t,"f",(function(){return d})),i.d(t,"a",(function(){return l}));const a=e=>({type:"USER_DOMAIN_VERIFIED",payload:{verifiedWebsite:e}}),d=e=>({type:"USER_DOMAIN_UNVERIFIED",payload:{verifiedWebsite:e}});function l(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}},Pqnw:function(e,t,i){function n(e,t){return{type:"FEED_INVALIDATE",payload:{feedType:e,feedId:t}}}i.d(t,"a",(function(){return n}))},Q7uW:function(e,t,i){i.d(t,"a",(function(){return s}));var n=i("n6mq"),o=i("nKUr");function s(e){const{htmlFor:t,errorMessage:i}=e;return Object(o.jsx)(n.z,{htmlFor:t,children:Object(o.jsx)(n.f,{marginTop:1,children:Object(o.jsx)(n.bb,{color:"red",size:"md",children:i})})})}},Sihc:function(e,t,i){i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return u}));var n=i("Pqnw"),o=i("uVIr"),s=i("VqlB"),r=i("eOdZ"),a=i("oN2T"),d=i("KFEb"),l=i("Wer7");function c(e,t){return{type:"SECTION_ADDED",payload:{boardId:e,section:t}}}function u({boardId:e,name:t,nameSource:i,pinImport:u,initialPinIds:h=[]}){let b=0;"RECOMMENDATION"===i?b=1:"EDITED_RECOMMENDATION"===i&&(b=2);const p={board_id:e,initial_pins:u&&!u.all?u.pinIds:h,name:t,name_source:b};return t=>r.a.create("BoardSectionResource",p).callCreate({showError:!1}).then(({resource_response:{data:i}})=>{t(c(e,i)),t(Object(o.a)({feedId:e,feedType:d.a.BOARD_SECTIONS,itemIds:[i.id],itemType:"board_section"})),t(Object(a.c)(e,"pin_count")),t(Object(l.f)("BoardSectionsRepinResource",{board_id:e}));const{all:r,pinIds:h}=u||{all:!1,pinIds:[]};return r?new Promise((n,o)=>t(Object(s.a)({inverseSelection:!0,selectedPinIds:h,source:{boardId:e,sectionId:null},target:{boardId:e,sectionId:i.id}})).then(()=>n(i)).catch(o)):(h.length>0&&t(Object(n.a)(d.a.BOARD_PINS,e)),i)})}},V711:function(e,t,i){i.d(t,"a",(function(){return x}));var n=i("q1tI"),o=i("/MKj"),s=i("8cMa"),r=i("JW66"),a=i("rrvb"),d=i("v/Q4"),l=i("0BOE"),c=i("jdx6"),u=i("Wer7"),h=i("yweb"),b=i("w70y"),p=i("n6mq"),f=i("oN2T"),j=i("nKUr");function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m({board:e,hovered:t,searchQuery:i}){const n=e.privacy===r.a.BoardPrivacy.SECRET;return Object(j.jsxs)(p.f,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:[Object(j.jsx)(p.f,{flex:"grow",children:Object(j.jsx)(p.bb,{weight:"bold",children:Object(c.b)(i,e.name)})}),Object(j.jsxs)(p.f,{direction:"row",display:"flex",flex:"none",children:[n&&Object(j.jsx)(s.a,{type:"secret"}),e.is_collaborative&&Object(j.jsx)(s.a,{type:"group"})]})]})}class y extends n.Component{constructor(e){super(e),g(this,"getSections",()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return[];const{searchQuery:t}=this.state,{boardResource:{data:{all_boards:i}}}=this.props;return t.length>=2?[{items:Object(l.a)(i,t)}]:[{items:i}]}),g(this,"createBtnDisabled",()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return!1;const{boardResource:{data:{all_boards:t}}}=this.props,{searchQuery:i}=this.state;return t.some(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())===i.toLowerCase()})}),g(this,"handleBoardCreate",e=>()=>{const{searchQuery:e}=this.state;if(!e)return;const{createBoard:t,invalidateBoardPickerBoardsResource:i,onBoardCreate:n}=this.props;i(),n?n(e):t({name:e,privacy:"public"}).then(e=>{const{onBoardChosen:t}=this.props;t(e)})}),g(this,"handleBoardSelected",e=>{this.props.onBoardChosen(e),this.setState({selectedBoard:e})}),g(this,"handleSearchQueryUpdate",e=>{this.setState({searchQuery:e})}),g(this,"renderRow",({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return Object(j.jsx)(m,{board:e,hovered:t,searchQuery:i})}),this.state={searchQuery:"",selectedBoard:e.board}}render(){const{boardResource:e,board:t,isBoardlessPinsBoard:i,isQuickCreatesBoard:n,isStoryPin:o,viewer:s}=this.props,{searchQuery:r,selectedBoard:d}=this.state;let l=this.props.i18n._("Select a board","Label for selecting a board in Edit Pin Modal","Label for selecting a board in Edit Pin Modal");return t?l=n?this.props.i18n._("Choose board","BoardPickerFlyout.displayBoardName.quickCreatesBoard","Title for board picker when current board is a quick creates board"):i?this.props.i18n._("Profile","BoardPickerFlyout.displayBoarName.boardlessPins","Title indicating the pin is saved to profile"):t.name:d&&(l=d.name),Object(j.jsxs)(p.f,{children:[Object(j.jsx)(p.U,{accessibilityLabel:this.props.i18n._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!e.isLoaded}),e.data&&Object(j.jsx)(a.a,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:l,isStoryPin:o,onCreate:this.handleBoardCreate(s),onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleBoardSelected,renderRow:this.renderRow,searchQuery:r,sections:this.getSections()})]})}}function x(e){const t=Object(h.c)(),i=Object(o.useDispatch)(),n=Object(d.a)(),s=n.isAuth?n.username:"",r=Object(o.useSelector)(({advertiser:e})=>e),a=n.isAuth&&r&&r.owner_user_id!==n.id,l=a?r.id:null,c=a?r.owner_user_id:null,p=Object(b.a)({name:"BoardPickerBoardsResource",options:{pin_id:e.pinId,field_set_key:"board_picker",onlyFetchBoards:!0,username:c,...l&&c?{advertiser_id:l,filter:"protected",username:c}:{}},allowStale:!1});return Object(j.jsx)(y,{...e,advertiser_id:l,boardResource:p,createBoard:e=>i(Object(f.g)(e,void 0,s)),invalidateBoardPickerBoardsResource:()=>{i(Object(u.f)("BoardPickerBoardsResource",{field_set_key:"board_picker"}))},username:c,viewer:n,i18n:t})}},VqlB:function(e,t,i){i.d(t,"b",(function(){return f})),i.d(t,"a",(function(){return j}));var n=i("3z7j"),o=i("Pqnw"),s=i("uVIr"),r=i("MhBu"),a=i("eOdZ"),d=i("oN2T"),l=i("KFEb"),c=i("1inl"),u=i("Ye/N");function h(e){c.a.showError(function(e){switch(e.api_error_code){case 2171:case 2172:case 2173:return u.a._("Please wait until the previous board action finishes.");default:return e.message}}(e))}const b=e=>Object(o.a)(e.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,e.sectionId||e.boardId);function p(e,t){const{source:i,target:o}=e;o.boardId!==i.boardId?(t(Object(d.c)(i.boardId,"pin_count")),t(Object(d.c)(o.boardId,"pin_count"))):i.sectionId&&o.sectionId||t(Object(d.c)(o.boardId,"pin_count")),i.sectionId&&t(Object(n.a)(i.sectionId)),o.sectionId&&t(Object(n.a)(o.sectionId))}function f(e){return t=>{const{selectedPinIds:i,source:n,target:o}=e;t(Object(r.a)({feedId:n.sectionId||n.boardId,feedType:n.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:i,itemType:"pin"})),t(Object(s.a)({feedId:o.sectionId||o.boardId,feedType:o.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:i,itemType:"pin"})),p(e,t)}}function j(e){return t=>function(e,t){const{inverseSelection:i,selectedPinIds:n,source:o,target:d}=e;if(o.boardId===d.boardId&&(o.sectionId||null)===(d.sectionId||null))return Promise.reject();if(i){const e={board_id:o.boardId,new_board_id:d.boardId,old_section_id:o.sectionId||void 0,new_section_id:d.sectionId||void 0,pin_ids:n};return a.a.create("BulkEditSelectAllResource",e).callUpdate({showError:!1}).then(()=>Promise.all([t(b(o)),t(b(d))])).catch(h)}{const e=(e,i)=>{t(Object(r.a)({feedId:e.sectionId||e.boardId,feedType:e.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:n,itemType:"pin"})),t(Object(s.a)({feedId:i.sectionId||i.boardId,feedType:i.sectionId?l.a.SECTION_PINS:l.a.BOARD_PINS,itemIds:n,itemType:"pin"}))};e(o,d);const i=()=>e(d,o);if(d.boardId===o.boardId){if(d.sectionId){const e={section_id:d.sectionId,pins:n};return a.a.create("BoardSectionEditResource",e).callUpdate({showError:!1}).catch(e=>{i(),h(e)})}{const e={section_id:o.sectionId,pins:n};return a.a.create("BoardSectionPinsResource",e).callDelete({showError:!1}).catch(e=>{i(),h(e)})}}{const e={board_id:d.boardId,section_id:d.sectionId||void 0,pin_ids:n};return a.a.create("BulkEditResource",e).callUpdate({showError:!1}).catch(e=>{i(),h(e)})}}}(e,t).then(()=>p(e,t))}},Wrea:function(e,t,i){i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return l}));var n=i("Wer7");const o=(e,t)=>i=>i(Object(n.a)("BoardResource",{board_id:e,field_set_key:t})),s=e=>o(e,"pin_count"),r=e=>({type:"BOARD_PIN_COUNT_CHANGED",payload:e}),a=e=>({type:"BOARD_INVITE_ACCEPTED_BY_VIEWER",payload:{boardId:e}}),d=(e,t)=>({type:"BOARD_COVER_IMAGE_UPDATED",payload:{boardId:e,coverPin:t}}),l=e=>({type:"BOARD_DISABLE_MORE_IDEAS_BADGING",payload:{boardId:e}})},eIuQ:function(e,t,i){i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return a}));var n=i("Ye/N");function o(e){return e?n.a._("Title too long. Make sure all cards' titles have less than 100 characters","Title entered is too long while editing a carousel pin and/or one of its pins","Title entered is too long while editing a carousel pin and/or one of its pins"):n.a._("Title too long. Make sure title has less than 100 characters","Title entered is too long while editing a pin","Title entered is too long while editing a pin")}function s(e){return e?n.a._("Description too long. Make sure all cards' descriptions have less than 500 characters","Description entered is too long while editing a carousel pin and/or one of its pins","Description entered is too long while editing a carousel pin and/or one of its pins"):n.a._("Description too long. Make sure description has less than 500 characters","Description entered is too long while editing a pin","Description entered is too long while editing a pin")}function r(e){return n.a._("Too many mentions. Make sure you have at most 5.","editPinModal.errorMessages.userMentionOverLimit","Too many mentions used in the description")}function a(e){return e?n.a._("Need to provide a valid URL. Make sure all cards' links are valid","Invalid URL/link provided while editing a carousel pin and/or one of its pins","Invalid URL/link provided while editing a carousel pin and/or one of its pins"):n.a._("Need to provide a valid URL. Make sure the link is valid","Invalid URL/link provided while editing a pin","Invalid URL/link provided while editing a pin")}},gdcG:function(e,t,i){i.d(t,"a",(function(){return s}));var n=i("2WXK"),o=i("nKUr");function s(e){return function(t){const{isHovering:i,hoverHandlers:s}=Object(n.a)();return Object(o.jsx)(e,{...t,hoverHandlers:s,isHovering:i})}}},jdx6:function(e,t,i){i.d(t,"b",(function(){return d}));var n=i("8cMa"),o=i("JW66"),s=i("yweb"),r=i("n6mq"),a=i("nKUr");function d(e,t=""){const i=e&&e.length>1?new RegExp(e,"i"):"";return e&&e.length>1?t.split(i).reduce((i,n,o)=>{if(i.length>0&&e&&e.length){const s=t.toLowerCase().indexOf(e.toLowerCase());return i.concat(Object(a.jsx)("em",{style:{borderBottom:"1px solid #333",fontStyle:"normal",paddingBottom:"1px"},children:t.substring(s,s+e.length)},o),n)}return[n]},[]):t}t.a=function(e){const t=Object(s.c)(),{disabled:i,item:l,isSection:c,isSelectMode:u,isWithinSectionPicker:h,saveState:b,searchQuery:p,selected:f}=e,j=c?null:l,g=c?l:null,m=g&&g.title||j&&j.name||"";let y="",x=!1,_="",O=0;j&&({image_cover_url:y,is_collaborative:x,privacy:_,section_count:O=0}=j);const v=d(p,m),S=_===o.a.BoardPrivacy.SECRET,C=!i&&(f||!!b),w=!h&&"number"==typeof O&&O>0,I="number"==typeof O&&O>0?"boardWithSection":"boardWithoutSection",E=u?t._("Select","Board select button label","Board select button label"):t._("Save","Pin save button label","Pin save button label");return Object(a.jsxs)(r.f,{alignItems:"center",color:C?"lightGray":"white",display:"flex",paddingX:6,paddingY:2,"data-test-id":I,children:[j?Object(a.jsx)(r.f,{height:36,width:36,color:"lightGray",overflow:"hidden",rounding:2,marginEnd:2,flex:"none",children:y?Object(a.jsx)(r.y,{src:y,alt:m,fit:"cover",naturalWidth:1,naturalHeight:1}):Object(a.jsx)("span",{})}):Object(a.jsx)(r.f,{height:36,paddingX:2}),Object(a.jsxs)(r.f,{alignItems:"center",justifyContent:"between",display:"flex",flex:"grow",children:[Object(a.jsx)(r.bb,{color:i?"gray":"darkGray",size:"md",lineClamp:1,weight:"bold",children:v}),(w||!C)&&Object(a.jsxs)(r.f,{alignItems:"center",display:"flex",children:[S&&Object(a.jsx)(n.a,{type:"secret"}),x&&Object(a.jsx)(n.a,{type:"group"}),w&&Object(a.jsx)(n.a,{type:"sections"})]}),!w&&C&&!b&&Object(a.jsxs)(r.f,{alignItems:"center",color:"red","data-test-id":"BoardPickerSaveButton",display:"flex",flex:"none",paddingX:3,paddingY:2,rounding:4,children:[!u&&Object(a.jsx)(r.f,{dangerouslySetInlineStyle:{__style:{marginRight:3,marginLeft:-6}},children:Object(a.jsx)(r.w,{accessibilityLabel:"",color:"white",icon:"pin",inline:!0,size:20})}),Object(a.jsx)(r.bb,{color:"white",overflow:"normal",size:"md",weight:"bold",children:E})]}),!w&&C&&"loading"===b&&Object(a.jsx)(r.f,{dangerouslySetInlineStyle:{__style:{transform:"scale(0.7)"}},maxHeight:35,children:Object(a.jsx)(r.U,{accessibilityLabel:t._("Saving","Accessibility label for saving a pin to a board","Accessibility label for saving a pin to a board"),show:!0})})]})]})}},"kT2/":function(e,t,i){var n=i("q1tI"),o=i("JW66"),s=i("yweb"),r=i("n6mq"),a=i("nKUr");const d=e=>{const t=e.split("\n");t.push("");const i=[];let n,o=[];return t.forEach(e=>{const t=e.indexOf("•");t>-1?(n||(n=""),o.push(e.substring(t+1).trim())):((n||o.length>0)&&i.push({heading:n,items:o}),n=e,o=[])}),i},l=e=>{let t="";return e.forEach((i,n)=>{const{heading:o,items:s}=i;o&&(t+=o),s&&s.length>0&&(t+="\n• "+s.join("\n• ")),n<e.length-1&&(t+="\n\n")}),t};t.a=function({header:e,helperText:t,listBlocks:i,onUpdate:c,placeholderListBlocks:u}){const h=Object(s.c)(),b=l(u||[{heading:h._("What you'll need","storyboard.detailsList.placeholder","Placeholder text header for details list of story Pin"),items:[h._("Write a bullet list of tools, materials and anything else!","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin"),h._("Type it up or copy and paste.","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin")]}]),[p,f]=Object(n.useState)(i?l(i):"");return Object(a.jsx)(r.f,{children:Object(a.jsx)(r.cb,{id:"storyboard-details-list",helperText:t,label:e,onChange:({value:e})=>{f(e),c(d(e))},onBlur:()=>{""===p.trim()&&f("")},onKeyDown:({event:e,value:t})=>{const{keyCode:i,target:n,shiftKey:s}=e;if(n instanceof HTMLTextAreaElement){const{selectionStart:r,selectionEnd:a}=n;if(r===a){let a=0,l=0,u="";if(i===o.a.KeyCode.ENTER?"\n• "!==t.substring(r-3,r)||"\n"!==t.substring(r,r+1)&&r!==t.length?s||"\n"===t.substring(r-1,r)||(a=0,u="\n• "):(a=-3,u="\n"):i!==o.a.KeyCode.BACKSPACE&&i!==o.a.KeyCode.DELETE||("\n• "===t.substring(r-3,r)?a=-3:"\n•"===t.substring(r-2,r)?a=-2:"\n"===t.substring(r-1,r)&&"•"===t.substring(r,r+1)&&(a=-1,l=1)),0!==a||0!==l||""!==u){const i=t.substring(0,r+a)+u+t.substring(r+l);f(i);const o=r+a+u.length;setTimeout(()=>{n.selectionStart=o,n.selectionEnd=o},10),c(d(i)),e.preventDefault()}}}},placeholder:b,rows:7,value:p})})}},mEMi:function(e,t,i){i.d(t,"a",(function(){return a}));var n=i("q1tI"),o=i("DzJC"),s=i.n(o);function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a extends n.PureComponent{constructor(...e){super(...e),r(this,"setContainerRef",e=>{this.containerRef=e}),r(this,"fetchMoreIfNecessary",s()(()=>{const{fetchMore:e,scrollBuffer:t}=this.props;e&&this.containerRef&&(({scrollTop:e,clientHeight:t,scrollHeight:i},n)=>e+t+(n?n(t):2*t)>i)(this.containerRef,t)&&e()},200))}componentDidMount(){setTimeout(this.fetchMoreIfNecessary)}componentDidUpdate(){this.fetchMoreIfNecessary()}render(){const{children:e}=this.props;return e({onScroll:this.fetchMoreIfNecessary,setRef:this.setContainerRef})}}},oN2T:function(e,t,i){i.d(t,"c",(function(){return f})),i.d(t,"b",(function(){return j})),i.d(t,"j",(function(){return g})),i.d(t,"g",(function(){return m})),i.d(t,"e",(function(){return y})),i.d(t,"n",(function(){return x})),i.d(t,"h",(function(){return O})),i.d(t,"d",(function(){return v})),i.d(t,"a",(function(){return S})),i.d(t,"m",(function(){return C})),i.d(t,"k",(function(){return w})),i.d(t,"l",(function(){return I})),i.d(t,"f",(function(){return E})),i.d(t,"i",(function(){return k}));var n=i("4dcN"),o=i("Pqnw"),s=i("7w6Q"),r=i("eOdZ"),a=i("nrog"),d=i("KFEb"),l=i("5FNA"),c=i("NjDU"),u=i("Wer7");const h="board_create",b="board_delete",p="board_edit";function f(e,t){return Object(u.a)("BoardResource",{board_id:e,field_set_key:t})}function j(e={},t,i){return{type:"BOARD_CREATE_COMPLETE",payload:{options:e,board:t},error:i}}function g(e){return t=>{e&&Object(l.b)(e).forEach(e=>{t(e)})}}function m(e,t,i){const o={...e};return s=>(s({type:"BOARD_CREATE",payload:{board:e}}),r.a.create("BoardResource",o).callCreate().then(e=>{n.a.trackEvent(h,"success");const r=e.resource_response.data;return r&&(s(g(i)),null!=t&&t.isFBC||s(j(o,r)),s(Object(a.a)(r.owner.id))),r}).catch(e=>{throw n.a.trackEvent(h,"error"),e}))}function y(e={},t,i){return{type:"BOARD_UPDATE_COMPLETE",payload:{options:e,board:t},error:i}}function x(e){return t=>{const i=void 0===e.collaborator_requests_enabled||null===e.collaborator_requests_enabled?{}:{collaborator_requests_enabled:e.collaborator_requests_enabled},o={board_id:e.id,name:e.name,description:e.description,category:e.category,collaborator_permissions_setting:e.collaborator_permissions_setting,privacy:e.privacy,collab_board_email:e.collab_board_email,collaborator_invites_enabled:e.collaborator_invites_enabled,allow_homefeed_recommendations:e.allow_homefeed_recommendations,...i};return t({type:"BOARD_UPDATE",payload:{boardUpdateOptions:o}}),r.a.create("BoardResource",o).callUpdate().then(i=>{n.a.trackEvent(p,"success");const s=i&&i.resource_response&&i.resource_response.data||e;t(y(o,s))}).catch(e=>{throw n.a.trackEvent(p,"error"),e})}}function _(e,t){return{type:"BOARD_DELETE_COMPLETE",payload:{boardId:e},error:t}}function O(e){return(t,i)=>{var o;const s=i().boards.content[e],{pin_count:a}=s,{id:d=""}=null!==(o=s.owner)&&void 0!==o?o:{};return t({type:"BOARD_DELETE",payload:{boardId:e}}),r.a.create("BoardResource",{board_id:e}).callDelete().then(()=>{n.a.trackEvent(b,"error"),t(_(e)),t(Object(c.c)({userId:d,increment:"number"==typeof a?-a:0}))}).catch(e=>{throw n.a.trackEvent(b,"error"),e})}}function v(e){return{type:"BOARD_PIN_TO",payload:{board:e}}}function S(e){return t=>(t(function(e){return{type:"BOARD_ARCHIVED",payload:{boardId:e}}}(e)),r.a.create("BoardArchiveResource",{boardId:e}).callUpdate())}function C(e){return t=>(t(function(e){return{type:"BOARD_UNARCHIVED",payload:{boardId:e}}}(e)),r.a.create("BoardArchiveResource",{boardId:e}).callDelete())}function w(e,t){return i=>r.a.create("BoardsMergeResource",{source_board_id:e,target_board_id:t}).callUpdate().then(()=>Promise.all([i(_(e)),i(f(t,"pin_count")),i(Object(o.a)(d.a.BOARD_SECTIONS,t))]))}function I(e,t){return i=>r.a.create("SocialSearchCampaignResource",{boardId:e}).callGet().then(e=>{if(!e||!e.resource_response){return i({type:"SET_SOCIAL_SEASONAL_BOARD",payload:{isSocialSeasonalBoard:!1,socialHeaderBgImage:"",socialHeaderBgColor:"",textIconColor:""}})}const n=e.resource_response.data||{},o=(n.model||{}).custom_properties||{},{campaign_id:r="unknown"}=o,a=n.display_data||{},d={isSocialSeasonalBoard:!!n.display_data,socialHeaderBgImage:a.header_image,socialHeaderBgColor:a.header_background_color,textIconColor:a.text_icon_color};return s.a.increment(`web.seasonal_board.${r}.${t}.land`),i({type:"SET_SOCIAL_SEASONAL_BOARD",payload:d})})}function E(){return e=>e({type:"SET_SOCIAL_SEASONAL_BOARD",payload:{isSocialSeasonalBoard:!1,socialHeaderBgImage:"",socialHeaderBgColor:"",textIconColor:""}})}function k(e){return{type:"BOARD_DISMISS_SENSITIVITY_SCREEN",payload:{boardId:e}}}},qVfT:function(e,t,i){i.d(t,"a",(function(){return o}));var n=i("eOdZ");function o(e,t,i){return async o=>{const s=n.a.create("ApiResource",{url:`/v3/pins/${e}/notes/`,data:{pin_note_content:i}});let r;r=i?t?await s.callUpdate():await s.callCreate():await s.callDelete();const{resource_response:a}=r;o(function(e,t){return{type:"PIN_NOTE_UPDATE",payload:{pinId:e,pinNote:t}}}(e,null==a?void 0:a.data))}}},rrvb:function(e,t,i){var n=i("q1tI"),o=i("9QW3"),s=i("NdQN"),r=i("IBrh"),a=i("yweb"),d=i("gdcG"),l=i("n6mq"),c=i("nKUr");function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends n.Component{constructor(...e){super(...e),u(this,"state",{showFlyout:!1}),u(this,"setContainerRef",e=>{this.containerRef=e}),u(this,"handleCreate",()=>{this.hideFlyout();const{onCreate:e}=this.props;e&&e()}),u(this,"handleSelectItem",e=>{this.hideFlyout();const{onSelect:t,onCreate:i}=this.props;e?t(e):i&&i()}),u(this,"handleDropdownTouch",()=>{this.setState(e=>({showFlyout:!e.showFlyout}))}),u(this,"handleHideFlyout",e=>{this.containerRef&&e.target instanceof HTMLElement&&!this.containerRef.contains(e.target)&&this.hideFlyout()}),u(this,"hideFlyout",()=>{const{hoverHandlers:{onMouseLeave:e}}=this.props;e(),this.setState({showFlyout:!1})})}componentDidMount(){document.addEventListener("click",this.handleHideFlyout,{capture:!0})}componentWillUnmount(){document.removeEventListener("click",this.handleHideFlyout,{capture:!0})}render(){const{dropdownValue:e,fetchMore:t,hoverHandlers:{onMouseOver:i,onMouseLeave:n},isHovering:a,isStoryPin:d,onCreate:u,onSearchQueryUpdate:h,renderRow:b,searchQuery:p,sections:f,createBtnDisabled:j}=this.props,{showFlyout:g}=this.state;this.indexManager=new o.a(f.map(e=>e.items)),this.indexManager.setSelectItem(this.handleSelectItem);const m=!p.trim()||!!j;return Object(c.jsxs)("div",{ref:this.setContainerRef,style:{...d?{flex:"grow"}:{}},children:[Object(c.jsx)(l.ab,{fullWidth:!!d,onMouseEnter:i,onMouseLeave:n,onTap:this.handleDropdownTouch,rounding:2,children:Object(c.jsxs)(l.f,{alignItems:"center",color:a?"lightWash":"lightGray",direction:"row",display:"flex",flex:"grow",paddingX:4,paddingY:d?4:3,rounding:d?4:2,children:[Object(c.jsx)(l.f,{display:"flex",flex:"grow",children:Object(c.jsx)(l.bb,{weight:"bold",children:e})}),Object(c.jsx)(l.w,{accessibilityLabel:"",color:"darkGray",icon:"arrow-down",size:14})]})}),g&&Object(c.jsx)(l.f,{position:"relative",children:Object(c.jsxs)(l.f,{borderStyle:"sm",color:"white",dangerouslySetInlineStyle:{__style:{zIndex:1}},direction:"column",display:"flex",overflow:"hidden",position:"absolute",rounding:d?4:2,width:"100%",children:[Object(c.jsx)(l.f,{children:Object(c.jsxs)(l.f,{display:"flex",marginStart:-1,marginEnd:-1,padding:2,children:[Object(c.jsx)(l.f,{display:"flex",flex:"grow",paddingX:1,children:Object(c.jsx)(s.a,{hideIcon:!0,indexManager:this.indexManager,onChange:h,value:p})}),u&&Object(c.jsx)(l.f,{paddingX:1,children:Object(c.jsx)(l.g,{disabled:m,onClick:this.handleCreate,text:this.props.i18n._("Create","board or section dropdown create button","board or section dropdown create button")})})]})}),Object(c.jsx)(r.a,{fetchMore:t,indexManager:this.indexManager,maxHeight:240,onSelectItem:this.handleSelectItem,renderItem:b,sections:f})]})})]})}}t.a=Object(d.a)((function(e){const t=Object(a.c)();return Object(c.jsx)(h,{...e,i18n:t})}))},uVIr:function(e,t,i){function n(e){return{type:"FEED_ITEMS_ADDED",payload:e}}i.d(t,"a",(function(){return n}))},x12c:function(e,t,i){i.d(t,"b",(function(){return a}));let n=0;class o{constructor(e,t,i){this.pubsub=e,this.target=t,this.subscriberOptions=i,this.topics={}}publish(e,t,i){return i?this.getHandler()(this.target,e,t,i):this.getHandler()(this.target,e,t),this}subscribe(...e){return this.getChannel().addSubscriber(this,e),e.forEach(e=>{this.topics[e]=!0}),this}unsubscribe(...e){return 0===e.length&&(e=this.getTopics()),e.forEach(e=>delete this.topics[e]),this.getChannel().removeSubscriber(this,e),this}getChannel(){return this.pubsub.getChannel(this.target)}getHandler(){return this.subscriberOptions.handler}getName(){return this.subscriberOptions.name}getId(){return this.id||(this.id=n,n+=1),this.id}getTopics(){return Object.keys(this.topics)}}class s{constructor(e,t){this.pubsub=e,this.target=t,this.subscribers=[],this.filters={},this.messages={}}addSubscriber(e,t){const i=e.getId();return this.subscribers[i]=e,t.forEach(t=>{this.filters[t]||(this.filters[t]={}),this.filters[t][i]||(this.filters[t][i]=e)}),e}removeSubscriber(e,t){const i=e.getId();t.forEach(e=>{this.filters[e]&&delete this.filters[e][i]}),this.subscribers.length<1&&this.pubsub.clearChannel(this.target)}publish(e,t){Object.values(this.filters[e]||{}).forEach(i=>{i.publish(e,t)}),"*"!==e&&this.publish("*",t),this.messages[e]=t}getSubscribers(...e){if(!e.length)return this.subscribers;const t={};return e.forEach(e=>{Object.assign(t,this.filters[e])}),Object.values(t)}unsubscribeAll(){this.subscribers.forEach(e=>{e.unsubscribe()})}}const r={Subscriber:o,Channel:s,instance:new class{constructor(e){this.ns=e,this.channels={}}_subscribe(e,t,i){const n=new o(this,e,{handler:i});return n.subscribe(t),n}subscribe(e,t,i){return this._subscribe(e,t,i)}publish(e,t,i){this.getChannel(e).publish(t,i)}getChannel(e){return this.channels[e]||(this.channels[e]=new s(this,e)),this.channels[e]}clearChannel(e){const t=this.channels[e];t&&(t.unsubscribeAll(),delete this.channels[e])}}("local")},a=r.instance;t.a=r},xOLo:function(e,t,i){i.r(t),i.d(t,"CarouselSliders",(function(){return p}));var n=i("/MKj"),o=i("XSD5"),s=i("6/Sz"),r=i("yweb"),a=i("0nTG"),d=i("U4JR"),l=i("n6mq"),c=i("nKUr");const u={slider:{cursor:"pointer",height:"100%",position:"relative",width:"10%",zIndex:"105",pointerEvents:"auto"}},h=(e,t,i,n,o,s,r,l,c,u)=>{if(!u||!o){const{carousel_slots:u,id:h}=o;Object(d.b)(108,{...c,objectId:t,component:l,view:r,viewParameter:s,eventData:{pinCarouselSlotEventData:{carouselSlotId:(null==u?void 0:u[i])&&Number(u[i].id),carouselDataId:Number(h),carouselSlotIndex:i,toCarouselSlotIndex:n}},...Object(a.f)(e)||{}})}},b=(e,t,i,n,o,s)=>{s||void 0===n||(e.preventDefault(),e.stopPropagation(),n(t,i)),void 0!==o&&o(i)},p=({carouselIndex:e,carouselData:t,changeCarouselSlotIndex:i,handleCarouselSwipe:n,pin:o,pinId:s,contextLogData:a,viewParameter:d,viewType:p,componentType:f,isEditMode:j})=>{const g=Object(r.c)();if(!t)return null;const{carousel_slots:m=[],index:y=0}=t,x=void 0!==e?e:y,_=Math.max(0,x-1),O=Math.min(m.length-1,x+1);return Object(c.jsxs)(l.f,{display:"flex",justifyContent:"between",position:"absolute",left:!0,right:!0,bottom:!0,top:!0,children:[Object(c.jsx)("div",{"data-test-id":"carousel-slider-left",role:"presentation",onClick:e=>{b(e,s,_,i,n,j),h(o,s,x,_,t,d,p,f,a,j)},onKeyUp:e=>{b(e,s,_,i,n,j),h(o,s,x,_,t,d,p,f,a,j)},style:u.slider,children:x>0&&Object(c.jsx)(l.f,{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.w,{color:"white",icon:"arrow-back",accessibilityLabel:g._("View Previous","Button to advance carousel to the previous image","Button to advance carousel to the previous image")})})}),Object(c.jsx)("div",{"data-test-id":"carousel-slider-right",role:"presentation",onClick:e=>{b(e,s,O,i,n,j),h(o,s,x,O,t,d,p,f,a,j)},onKeyUp:e=>{b(e,s,O,i,n,j),h(o,s,x,O,t,d,p,f,a,j)},style:u.slider,children:x<m.length-1&&Object(c.jsx)(l.f,{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",children:Object(c.jsx)(l.w,{color:"white",icon:"arrow-forward",accessibilityLabel:g._("View Next","Button to advance carousel to the next image","Button to advance carousel to the next image")})})})]})};t.default=Object(n.connect)(({pins:e},{carouselData:t,pinId:i})=>{const n=e[i];return{pin:n,carouselData:t||Object(s.a)(n)}},e=>({changeCarouselSlotIndex:(t,i)=>e(Object(o.a)(t,i))}))(p)}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/126-b45aa673f46283c927e6.mjs.map